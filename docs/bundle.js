!function(t){var n={};function r(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=n,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var a in t)r.d(e,a,function(n){return t[n]}.bind(null,a));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=2)}([function(t,n,r){"use strict";r.r(n);var e={};r.r(e),r.d(e,"EPSILON",function(){return d}),r.d(e,"ARRAY_TYPE",function(){return m}),r.d(e,"RANDOM",function(){return _}),r.d(e,"setMatrixArrayType",function(){return M}),r.d(e,"toRadian",function(){return v}),r.d(e,"equals",function(){return b});var a={};r.r(a),r.d(a,"create",function(){return x}),r.d(a,"clone",function(){return g}),r.d(a,"copy",function(){return T}),r.d(a,"identity",function(){return E}),r.d(a,"fromValues",function(){return R}),r.d(a,"set",function(){return y}),r.d(a,"transpose",function(){return w}),r.d(a,"invert",function(){return A}),r.d(a,"adjoint",function(){return D}),r.d(a,"determinant",function(){return q}),r.d(a,"multiply",function(){return U}),r.d(a,"rotate",function(){return F}),r.d(a,"scale",function(){return P}),r.d(a,"fromRotation",function(){return B}),r.d(a,"fromScaling",function(){return I}),r.d(a,"str",function(){return S}),r.d(a,"frob",function(){return L}),r.d(a,"LDU",function(){return X}),r.d(a,"add",function(){return N}),r.d(a,"subtract",function(){return G}),r.d(a,"exactEquals",function(){return V}),r.d(a,"equals",function(){return O}),r.d(a,"multiplyScalar",function(){return z}),r.d(a,"multiplyScalarAndAdd",function(){return C}),r.d(a,"mul",function(){return j}),r.d(a,"sub",function(){return H});var i={};r.r(i),r.d(i,"create",function(){return W}),r.d(i,"clone",function(){return Y}),r.d(i,"copy",function(){return k}),r.d(i,"identity",function(){return Q}),r.d(i,"fromValues",function(){return Z}),r.d(i,"set",function(){return K}),r.d(i,"invert",function(){return $}),r.d(i,"determinant",function(){return J}),r.d(i,"multiply",function(){return tt}),r.d(i,"rotate",function(){return nt}),r.d(i,"scale",function(){return rt}),r.d(i,"translate",function(){return et}),r.d(i,"fromRotation",function(){return at}),r.d(i,"fromScaling",function(){return it}),r.d(i,"fromTranslation",function(){return ot}),r.d(i,"str",function(){return ut}),r.d(i,"frob",function(){return ct}),r.d(i,"add",function(){return st}),r.d(i,"subtract",function(){return ft}),r.d(i,"multiplyScalar",function(){return lt}),r.d(i,"multiplyScalarAndAdd",function(){return ht}),r.d(i,"exactEquals",function(){return dt}),r.d(i,"equals",function(){return mt}),r.d(i,"mul",function(){return _t}),r.d(i,"sub",function(){return Mt});var o={};r.r(o),r.d(o,"create",function(){return pt}),r.d(o,"fromMat4",function(){return vt}),r.d(o,"clone",function(){return bt}),r.d(o,"copy",function(){return xt}),r.d(o,"fromValues",function(){return gt}),r.d(o,"set",function(){return Tt}),r.d(o,"identity",function(){return Et}),r.d(o,"transpose",function(){return Rt}),r.d(o,"invert",function(){return yt}),r.d(o,"adjoint",function(){return wt}),r.d(o,"determinant",function(){return At}),r.d(o,"multiply",function(){return Dt}),r.d(o,"translate",function(){return qt}),r.d(o,"rotate",function(){return Ut}),r.d(o,"scale",function(){return Ft}),r.d(o,"fromTranslation",function(){return Pt}),r.d(o,"fromRotation",function(){return Bt}),r.d(o,"fromScaling",function(){return It}),r.d(o,"fromMat2d",function(){return St}),r.d(o,"fromQuat",function(){return Lt}),r.d(o,"normalFromMat4",function(){return Xt}),r.d(o,"projection",function(){return Nt}),r.d(o,"str",function(){return Gt}),r.d(o,"frob",function(){return Vt}),r.d(o,"add",function(){return Ot}),r.d(o,"subtract",function(){return zt}),r.d(o,"multiplyScalar",function(){return Ct}),r.d(o,"multiplyScalarAndAdd",function(){return jt}),r.d(o,"exactEquals",function(){return Ht}),r.d(o,"equals",function(){return Wt}),r.d(o,"mul",function(){return Yt}),r.d(o,"sub",function(){return kt});var u={};r.r(u),r.d(u,"create",function(){return Qt}),r.d(u,"clone",function(){return Zt}),r.d(u,"copy",function(){return Kt}),r.d(u,"fromValues",function(){return $t}),r.d(u,"set",function(){return Jt}),r.d(u,"identity",function(){return tn}),r.d(u,"transpose",function(){return nn}),r.d(u,"invert",function(){return rn}),r.d(u,"adjoint",function(){return en}),r.d(u,"determinant",function(){return an}),r.d(u,"multiply",function(){return on}),r.d(u,"translate",function(){return un}),r.d(u,"scale",function(){return cn}),r.d(u,"rotate",function(){return sn}),r.d(u,"rotateX",function(){return fn}),r.d(u,"rotateY",function(){return ln}),r.d(u,"rotateZ",function(){return hn}),r.d(u,"fromTranslation",function(){return dn}),r.d(u,"fromScaling",function(){return mn}),r.d(u,"fromRotation",function(){return _n}),r.d(u,"fromXRotation",function(){return Mn}),r.d(u,"fromYRotation",function(){return pn}),r.d(u,"fromZRotation",function(){return vn}),r.d(u,"fromRotationTranslation",function(){return bn}),r.d(u,"fromQuat2",function(){return xn}),r.d(u,"getTranslation",function(){return gn}),r.d(u,"getScaling",function(){return Tn}),r.d(u,"getRotation",function(){return En}),r.d(u,"fromRotationTranslationScale",function(){return Rn}),r.d(u,"fromRotationTranslationScaleOrigin",function(){return yn}),r.d(u,"fromQuat",function(){return wn}),r.d(u,"frustum",function(){return An}),r.d(u,"perspective",function(){return Dn}),r.d(u,"perspectiveFromFieldOfView",function(){return qn}),r.d(u,"ortho",function(){return Un}),r.d(u,"lookAt",function(){return Fn}),r.d(u,"targetTo",function(){return Pn}),r.d(u,"str",function(){return Bn}),r.d(u,"frob",function(){return In}),r.d(u,"add",function(){return Sn}),r.d(u,"subtract",function(){return Ln}),r.d(u,"multiplyScalar",function(){return Xn}),r.d(u,"multiplyScalarAndAdd",function(){return Nn}),r.d(u,"exactEquals",function(){return Gn}),r.d(u,"equals",function(){return Vn}),r.d(u,"mul",function(){return On}),r.d(u,"sub",function(){return zn});var c={};r.r(c),r.d(c,"create",function(){return Cn}),r.d(c,"clone",function(){return jn}),r.d(c,"length",function(){return Hn}),r.d(c,"fromValues",function(){return Wn}),r.d(c,"copy",function(){return Yn}),r.d(c,"set",function(){return kn}),r.d(c,"add",function(){return Qn}),r.d(c,"subtract",function(){return Zn}),r.d(c,"multiply",function(){return Kn}),r.d(c,"divide",function(){return $n}),r.d(c,"ceil",function(){return Jn}),r.d(c,"floor",function(){return tr}),r.d(c,"min",function(){return nr}),r.d(c,"max",function(){return rr}),r.d(c,"round",function(){return er}),r.d(c,"scale",function(){return ar}),r.d(c,"scaleAndAdd",function(){return ir}),r.d(c,"distance",function(){return or}),r.d(c,"squaredDistance",function(){return ur}),r.d(c,"squaredLength",function(){return cr}),r.d(c,"negate",function(){return sr}),r.d(c,"inverse",function(){return fr}),r.d(c,"normalize",function(){return lr}),r.d(c,"dot",function(){return hr}),r.d(c,"cross",function(){return dr}),r.d(c,"lerp",function(){return mr}),r.d(c,"hermite",function(){return _r}),r.d(c,"bezier",function(){return Mr}),r.d(c,"random",function(){return pr}),r.d(c,"transformMat4",function(){return vr}),r.d(c,"transformMat3",function(){return br}),r.d(c,"transformQuat",function(){return xr}),r.d(c,"rotateX",function(){return gr}),r.d(c,"rotateY",function(){return Tr}),r.d(c,"rotateZ",function(){return Er}),r.d(c,"angle",function(){return Rr}),r.d(c,"str",function(){return yr}),r.d(c,"exactEquals",function(){return wr}),r.d(c,"equals",function(){return Ar}),r.d(c,"sub",function(){return Dr}),r.d(c,"mul",function(){return qr}),r.d(c,"div",function(){return Ur}),r.d(c,"dist",function(){return Fr}),r.d(c,"sqrDist",function(){return Pr}),r.d(c,"len",function(){return Br}),r.d(c,"sqrLen",function(){return Ir}),r.d(c,"forEach",function(){return Sr});var s={};r.r(s),r.d(s,"create",function(){return Lr}),r.d(s,"clone",function(){return Xr}),r.d(s,"fromValues",function(){return Nr}),r.d(s,"copy",function(){return Gr}),r.d(s,"set",function(){return Vr}),r.d(s,"add",function(){return Or}),r.d(s,"subtract",function(){return zr}),r.d(s,"multiply",function(){return Cr}),r.d(s,"divide",function(){return jr}),r.d(s,"ceil",function(){return Hr}),r.d(s,"floor",function(){return Wr}),r.d(s,"min",function(){return Yr}),r.d(s,"max",function(){return kr}),r.d(s,"round",function(){return Qr}),r.d(s,"scale",function(){return Zr}),r.d(s,"scaleAndAdd",function(){return Kr}),r.d(s,"distance",function(){return $r}),r.d(s,"squaredDistance",function(){return Jr}),r.d(s,"length",function(){return te}),r.d(s,"squaredLength",function(){return ne}),r.d(s,"negate",function(){return re}),r.d(s,"inverse",function(){return ee}),r.d(s,"normalize",function(){return ae}),r.d(s,"dot",function(){return ie}),r.d(s,"lerp",function(){return oe}),r.d(s,"random",function(){return ue}),r.d(s,"transformMat4",function(){return ce}),r.d(s,"transformQuat",function(){return se}),r.d(s,"str",function(){return fe}),r.d(s,"exactEquals",function(){return le}),r.d(s,"equals",function(){return he}),r.d(s,"sub",function(){return de}),r.d(s,"mul",function(){return me}),r.d(s,"div",function(){return _e}),r.d(s,"dist",function(){return Me}),r.d(s,"sqrDist",function(){return pe}),r.d(s,"len",function(){return ve}),r.d(s,"sqrLen",function(){return be}),r.d(s,"forEach",function(){return xe});var f={};r.r(f),r.d(f,"create",function(){return ge}),r.d(f,"identity",function(){return Te}),r.d(f,"setAxisAngle",function(){return Ee}),r.d(f,"getAxisAngle",function(){return Re}),r.d(f,"multiply",function(){return ye}),r.d(f,"rotateX",function(){return we}),r.d(f,"rotateY",function(){return Ae}),r.d(f,"rotateZ",function(){return De}),r.d(f,"calculateW",function(){return qe}),r.d(f,"slerp",function(){return Ue}),r.d(f,"invert",function(){return Fe}),r.d(f,"conjugate",function(){return Pe}),r.d(f,"fromMat3",function(){return Be}),r.d(f,"fromEuler",function(){return Ie}),r.d(f,"str",function(){return Se}),r.d(f,"clone",function(){return Le}),r.d(f,"fromValues",function(){return Xe}),r.d(f,"copy",function(){return Ne}),r.d(f,"set",function(){return Ge}),r.d(f,"add",function(){return Ve}),r.d(f,"mul",function(){return Oe}),r.d(f,"scale",function(){return ze}),r.d(f,"dot",function(){return Ce}),r.d(f,"lerp",function(){return je}),r.d(f,"length",function(){return He}),r.d(f,"len",function(){return We}),r.d(f,"squaredLength",function(){return Ye}),r.d(f,"sqrLen",function(){return ke}),r.d(f,"normalize",function(){return Qe}),r.d(f,"exactEquals",function(){return Ze}),r.d(f,"equals",function(){return Ke}),r.d(f,"rotationTo",function(){return $e}),r.d(f,"sqlerp",function(){return Je}),r.d(f,"setAxes",function(){return ta});var l={};r.r(l),r.d(l,"create",function(){return na}),r.d(l,"clone",function(){return ra}),r.d(l,"fromValues",function(){return ea}),r.d(l,"fromRotationTranslationValues",function(){return aa}),r.d(l,"fromRotationTranslation",function(){return ia}),r.d(l,"fromTranslation",function(){return oa}),r.d(l,"fromRotation",function(){return ua}),r.d(l,"fromMat4",function(){return ca}),r.d(l,"copy",function(){return sa}),r.d(l,"identity",function(){return fa}),r.d(l,"set",function(){return la}),r.d(l,"getReal",function(){return ha}),r.d(l,"getDual",function(){return da}),r.d(l,"setReal",function(){return ma}),r.d(l,"setDual",function(){return _a}),r.d(l,"getTranslation",function(){return Ma}),r.d(l,"translate",function(){return pa}),r.d(l,"rotateX",function(){return va}),r.d(l,"rotateY",function(){return ba}),r.d(l,"rotateZ",function(){return xa}),r.d(l,"rotateByQuatAppend",function(){return ga}),r.d(l,"rotateByQuatPrepend",function(){return Ta}),r.d(l,"rotateAroundAxis",function(){return Ea}),r.d(l,"add",function(){return Ra}),r.d(l,"multiply",function(){return ya}),r.d(l,"mul",function(){return wa}),r.d(l,"scale",function(){return Aa}),r.d(l,"dot",function(){return Da}),r.d(l,"lerp",function(){return qa}),r.d(l,"invert",function(){return Ua}),r.d(l,"conjugate",function(){return Fa}),r.d(l,"length",function(){return Pa}),r.d(l,"len",function(){return Ba}),r.d(l,"squaredLength",function(){return Ia}),r.d(l,"sqrLen",function(){return Sa}),r.d(l,"normalize",function(){return La}),r.d(l,"str",function(){return Xa}),r.d(l,"exactEquals",function(){return Na}),r.d(l,"equals",function(){return Ga});var h={};r.r(h),r.d(h,"create",function(){return Va}),r.d(h,"clone",function(){return Oa}),r.d(h,"fromValues",function(){return za}),r.d(h,"copy",function(){return Ca}),r.d(h,"set",function(){return ja}),r.d(h,"add",function(){return Ha}),r.d(h,"subtract",function(){return Wa}),r.d(h,"multiply",function(){return Ya}),r.d(h,"divide",function(){return ka}),r.d(h,"ceil",function(){return Qa}),r.d(h,"floor",function(){return Za}),r.d(h,"min",function(){return Ka}),r.d(h,"max",function(){return $a}),r.d(h,"round",function(){return Ja}),r.d(h,"scale",function(){return ti}),r.d(h,"scaleAndAdd",function(){return ni}),r.d(h,"distance",function(){return ri}),r.d(h,"squaredDistance",function(){return ei}),r.d(h,"length",function(){return ai}),r.d(h,"squaredLength",function(){return ii}),r.d(h,"negate",function(){return oi}),r.d(h,"inverse",function(){return ui}),r.d(h,"normalize",function(){return ci}),r.d(h,"dot",function(){return si}),r.d(h,"cross",function(){return fi}),r.d(h,"lerp",function(){return li}),r.d(h,"random",function(){return hi}),r.d(h,"transformMat2",function(){return di}),r.d(h,"transformMat2d",function(){return mi}),r.d(h,"transformMat3",function(){return _i}),r.d(h,"transformMat4",function(){return Mi}),r.d(h,"rotate",function(){return pi}),r.d(h,"angle",function(){return vi}),r.d(h,"str",function(){return bi}),r.d(h,"exactEquals",function(){return xi}),r.d(h,"equals",function(){return gi}),r.d(h,"len",function(){return Ti}),r.d(h,"sub",function(){return Ei}),r.d(h,"mul",function(){return Ri}),r.d(h,"div",function(){return yi}),r.d(h,"dist",function(){return wi}),r.d(h,"sqrDist",function(){return Ai}),r.d(h,"sqrLen",function(){return Di}),r.d(h,"forEach",function(){return qi});const d=1e-6;let m="undefined"!=typeof Float32Array?Float32Array:Array;const _=Math.random;function M(t){m=t}const p=Math.PI/180;function v(t){return t*p}function b(t,n){return Math.abs(t-n)<=d*Math.max(1,Math.abs(t),Math.abs(n))}function x(){let t=new m(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function g(t){let n=new m(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}function T(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t}function E(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function R(t,n,r,e){let a=new m(4);return a[0]=t,a[1]=n,a[2]=r,a[3]=e,a}function y(t,n,r,e,a){return t[0]=n,t[1]=r,t[2]=e,t[3]=a,t}function w(t,n){if(t===n){let r=n[1];t[1]=n[2],t[2]=r}else t[0]=n[0],t[1]=n[2],t[2]=n[1],t[3]=n[3];return t}function A(t,n){let r=n[0],e=n[1],a=n[2],i=n[3],o=r*i-a*e;return o?(o=1/o,t[0]=i*o,t[1]=-e*o,t[2]=-a*o,t[3]=r*o,t):null}function D(t,n){let r=n[0];return t[0]=n[3],t[1]=-n[1],t[2]=-n[2],t[3]=r,t}function q(t){return t[0]*t[3]-t[2]*t[1]}function U(t,n,r){let e=n[0],a=n[1],i=n[2],o=n[3],u=r[0],c=r[1],s=r[2],f=r[3];return t[0]=e*u+i*c,t[1]=a*u+o*c,t[2]=e*s+i*f,t[3]=a*s+o*f,t}function F(t,n,r){let e=n[0],a=n[1],i=n[2],o=n[3],u=Math.sin(r),c=Math.cos(r);return t[0]=e*c+i*u,t[1]=a*c+o*u,t[2]=e*-u+i*c,t[3]=a*-u+o*c,t}function P(t,n,r){let e=n[0],a=n[1],i=n[2],o=n[3],u=r[0],c=r[1];return t[0]=e*u,t[1]=a*u,t[2]=i*c,t[3]=o*c,t}function B(t,n){let r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=r,t[2]=-r,t[3]=e,t}function I(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t}function S(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function L(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))}function X(t,n,r,e){return t[2]=e[2]/e[0],r[0]=e[0],r[1]=e[1],r[3]=e[3]-t[2]*r[1],[t,n,r]}function N(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t}function G(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t}function V(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]}function O(t,n){let r=t[0],e=t[1],a=t[2],i=t[3],o=n[0],u=n[1],c=n[2],s=n[3];return Math.abs(r-o)<=d*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(e-u)<=d*Math.max(1,Math.abs(e),Math.abs(u))&&Math.abs(a-c)<=d*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(i-s)<=d*Math.max(1,Math.abs(i),Math.abs(s))}function z(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t}function C(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t[3]=n[3]+r[3]*e,t}const j=U,H=G;function W(){let t=new m(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Y(t){let n=new m(6);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n}function k(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t}function Q(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Z(t,n,r,e,a,i){let o=new m(6);return o[0]=t,o[1]=n,o[2]=r,o[3]=e,o[4]=a,o[5]=i,o}function K(t,n,r,e,a,i,o){return t[0]=n,t[1]=r,t[2]=e,t[3]=a,t[4]=i,t[5]=o,t}function $(t,n){let r=n[0],e=n[1],a=n[2],i=n[3],o=n[4],u=n[5],c=r*i-e*a;return c?(c=1/c,t[0]=i*c,t[1]=-e*c,t[2]=-a*c,t[3]=r*c,t[4]=(a*u-i*o)*c,t[5]=(e*o-r*u)*c,t):null}function J(t){return t[0]*t[3]-t[1]*t[2]}function tt(t,n,r){let e=n[0],a=n[1],i=n[2],o=n[3],u=n[4],c=n[5],s=r[0],f=r[1],l=r[2],h=r[3],d=r[4],m=r[5];return t[0]=e*s+i*f,t[1]=a*s+o*f,t[2]=e*l+i*h,t[3]=a*l+o*h,t[4]=e*d+i*m+u,t[5]=a*d+o*m+c,t}function nt(t,n,r){let e=n[0],a=n[1],i=n[2],o=n[3],u=n[4],c=n[5],s=Math.sin(r),f=Math.cos(r);return t[0]=e*f+i*s,t[1]=a*f+o*s,t[2]=e*-s+i*f,t[3]=a*-s+o*f,t[4]=u,t[5]=c,t}function rt(t,n,r){let e=n[0],a=n[1],i=n[2],o=n[3],u=n[4],c=n[5],s=r[0],f=r[1];return t[0]=e*s,t[1]=a*s,t[2]=i*f,t[3]=o*f,t[4]=u,t[5]=c,t}function et(t,n,r){let e=n[0],a=n[1],i=n[2],o=n[3],u=n[4],c=n[5],s=r[0],f=r[1];return t[0]=e,t[1]=a,t[2]=i,t[3]=o,t[4]=e*s+i*f+u,t[5]=a*s+o*f+c,t}function at(t,n){let r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=r,t[2]=-r,t[3]=e,t[4]=0,t[5]=0,t}function it(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t[4]=0,t[5]=0,t}function ot(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=n[0],t[5]=n[1],t}function ut(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function ct(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)}function st(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t[4]=n[4]+r[4],t[5]=n[5]+r[5],t}function ft(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t[4]=n[4]-r[4],t[5]=n[5]-r[5],t}function lt(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*r,t[5]=n[5]*r,t}function ht(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t[3]=n[3]+r[3]*e,t[4]=n[4]+r[4]*e,t[5]=n[5]+r[5]*e,t}function dt(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]}function mt(t,n){let r=t[0],e=t[1],a=t[2],i=t[3],o=t[4],u=t[5],c=n[0],s=n[1],f=n[2],l=n[3],h=n[4],m=n[5];return Math.abs(r-c)<=d*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(e-s)<=d*Math.max(1,Math.abs(e),Math.abs(s))&&Math.abs(a-f)<=d*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(i-l)<=d*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-h)<=d*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(u-m)<=d*Math.max(1,Math.abs(u),Math.abs(m))}const _t=tt,Mt=ft;function pt(){let t=new m(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function vt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],t}function bt(t){let n=new m(9);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n}function xt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function gt(t,n,r,e,a,i,o,u,c){let s=new m(9);return s[0]=t,s[1]=n,s[2]=r,s[3]=e,s[4]=a,s[5]=i,s[6]=o,s[7]=u,s[8]=c,s}function Tt(t,n,r,e,a,i,o,u,c,s){return t[0]=n,t[1]=r,t[2]=e,t[3]=a,t[4]=i,t[5]=o,t[6]=u,t[7]=c,t[8]=s,t}function Et(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Rt(t,n){if(t===n){let r=n[1],e=n[2],a=n[5];t[1]=n[3],t[2]=n[6],t[3]=r,t[5]=n[7],t[6]=e,t[7]=a}else t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8];return t}function yt(t,n){let r=n[0],e=n[1],a=n[2],i=n[3],o=n[4],u=n[5],c=n[6],s=n[7],f=n[8],l=f*o-u*s,h=-f*i+u*c,d=s*i-o*c,m=r*l+e*h+a*d;return m?(m=1/m,t[0]=l*m,t[1]=(-f*e+a*s)*m,t[2]=(u*e-a*o)*m,t[3]=h*m,t[4]=(f*r-a*c)*m,t[5]=(-u*r+a*i)*m,t[6]=d*m,t[7]=(-s*r+e*c)*m,t[8]=(o*r-e*i)*m,t):null}function wt(t,n){let r=n[0],e=n[1],a=n[2],i=n[3],o=n[4],u=n[5],c=n[6],s=n[7],f=n[8];return t[0]=o*f-u*s,t[1]=a*s-e*f,t[2]=e*u-a*o,t[3]=u*c-i*f,t[4]=r*f-a*c,t[5]=a*i-r*u,t[6]=i*s-o*c,t[7]=e*c-r*s,t[8]=r*o-e*i,t}function At(t){let n=t[0],r=t[1],e=t[2],a=t[3],i=t[4],o=t[5],u=t[6],c=t[7],s=t[8];return n*(s*i-o*c)+r*(-s*a+o*u)+e*(c*a-i*u)}function Dt(t,n,r){let e=n[0],a=n[1],i=n[2],o=n[3],u=n[4],c=n[5],s=n[6],f=n[7],l=n[8],h=r[0],d=r[1],m=r[2],_=r[3],M=r[4],p=r[5],v=r[6],b=r[7],x=r[8];return t[0]=h*e+d*o+m*s,t[1]=h*a+d*u+m*f,t[2]=h*i+d*c+m*l,t[3]=_*e+M*o+p*s,t[4]=_*a+M*u+p*f,t[5]=_*i+M*c+p*l,t[6]=v*e+b*o+x*s,t[7]=v*a+b*u+x*f,t[8]=v*i+b*c+x*l,t}function qt(t,n,r){let e=n[0],a=n[1],i=n[2],o=n[3],u=n[4],c=n[5],s=n[6],f=n[7],l=n[8],h=r[0],d=r[1];return t[0]=e,t[1]=a,t[2]=i,t[3]=o,t[4]=u,t[5]=c,t[6]=h*e+d*o+s,t[7]=h*a+d*u+f,t[8]=h*i+d*c+l,t}function Ut(t,n,r){let e=n[0],a=n[1],i=n[2],o=n[3],u=n[4],c=n[5],s=n[6],f=n[7],l=n[8],h=Math.sin(r),d=Math.cos(r);return t[0]=d*e+h*o,t[1]=d*a+h*u,t[2]=d*i+h*c,t[3]=d*o-h*e,t[4]=d*u-h*a,t[5]=d*c-h*i,t[6]=s,t[7]=f,t[8]=l,t}function Ft(t,n,r){let e=r[0],a=r[1];return t[0]=e*n[0],t[1]=e*n[1],t[2]=e*n[2],t[3]=a*n[3],t[4]=a*n[4],t[5]=a*n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function Pt(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=n[0],t[7]=n[1],t[8]=1,t}function Bt(t,n){let r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=r,t[2]=0,t[3]=-r,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function It(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=n[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function St(t,n){return t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[2],t[4]=n[3],t[5]=0,t[6]=n[4],t[7]=n[5],t[8]=1,t}function Lt(t,n){let r=n[0],e=n[1],a=n[2],i=n[3],o=r+r,u=e+e,c=a+a,s=r*o,f=e*o,l=e*u,h=a*o,d=a*u,m=a*c,_=i*o,M=i*u,p=i*c;return t[0]=1-l-m,t[3]=f-p,t[6]=h+M,t[1]=f+p,t[4]=1-s-m,t[7]=d-_,t[2]=h-M,t[5]=d+_,t[8]=1-s-l,t}function Xt(t,n){let r=n[0],e=n[1],a=n[2],i=n[3],o=n[4],u=n[5],c=n[6],s=n[7],f=n[8],l=n[9],h=n[10],d=n[11],m=n[12],_=n[13],M=n[14],p=n[15],v=r*u-e*o,b=r*c-a*o,x=r*s-i*o,g=e*c-a*u,T=e*s-i*u,E=a*s-i*c,R=f*_-l*m,y=f*M-h*m,w=f*p-d*m,A=l*M-h*_,D=l*p-d*_,q=h*p-d*M,U=v*q-b*D+x*A+g*w-T*y+E*R;return U?(U=1/U,t[0]=(u*q-c*D+s*A)*U,t[1]=(c*w-o*q-s*y)*U,t[2]=(o*D-u*w+s*R)*U,t[3]=(a*D-e*q-i*A)*U,t[4]=(r*q-a*w+i*y)*U,t[5]=(e*w-r*D-i*R)*U,t[6]=(_*E-M*T+p*g)*U,t[7]=(M*x-m*E-p*b)*U,t[8]=(m*T-_*x+p*v)*U,t):null}function Nt(t,n,r){return t[0]=2/n,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Gt(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Vt(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))}function Ot(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t[4]=n[4]+r[4],t[5]=n[5]+r[5],t[6]=n[6]+r[6],t[7]=n[7]+r[7],t[8]=n[8]+r[8],t}function zt(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t[4]=n[4]-r[4],t[5]=n[5]-r[5],t[6]=n[6]-r[6],t[7]=n[7]-r[7],t[8]=n[8]-r[8],t}function Ct(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=n[7]*r,t[8]=n[8]*r,t}function jt(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t[3]=n[3]+r[3]*e,t[4]=n[4]+r[4]*e,t[5]=n[5]+r[5]*e,t[6]=n[6]+r[6]*e,t[7]=n[7]+r[7]*e,t[8]=n[8]+r[8]*e,t}function Ht(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]}function Wt(t,n){let r=t[0],e=t[1],a=t[2],i=t[3],o=t[4],u=t[5],c=t[6],s=t[7],f=t[8],l=n[0],h=n[1],m=n[2],_=n[3],M=n[4],p=n[5],v=n[6],b=n[7],x=n[8];return Math.abs(r-l)<=d*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(e-h)<=d*Math.max(1,Math.abs(e),Math.abs(h))&&Math.abs(a-m)<=d*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(i-_)<=d*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(o-M)<=d*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(u-p)<=d*Math.max(1,Math.abs(u),Math.abs(p))&&Math.abs(c-v)<=d*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(s-b)<=d*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(f-x)<=d*Math.max(1,Math.abs(f),Math.abs(x))}const Yt=Dt,kt=zt;function Qt(){let t=new m(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Zt(t){let n=new m(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function Kt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function $t(t,n,r,e,a,i,o,u,c,s,f,l,h,d,_,M){let p=new m(16);return p[0]=t,p[1]=n,p[2]=r,p[3]=e,p[4]=a,p[5]=i,p[6]=o,p[7]=u,p[8]=c,p[9]=s,p[10]=f,p[11]=l,p[12]=h,p[13]=d,p[14]=_,p[15]=M,p}function Jt(t,n,r,e,a,i,o,u,c,s,f,l,h,d,m,_,M){return t[0]=n,t[1]=r,t[2]=e,t[3]=a,t[4]=i,t[5]=o,t[6]=u,t[7]=c,t[8]=s,t[9]=f,t[10]=l,t[11]=h,t[12]=d,t[13]=m,t[14]=_,t[15]=M,t}function tn(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function nn(t,n){if(t===n){let r=n[1],e=n[2],a=n[3],i=n[6],o=n[7],u=n[11];t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=r,t[6]=n[9],t[7]=n[13],t[8]=e,t[9]=i,t[11]=n[14],t[12]=a,t[13]=o,t[14]=u}else t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15];return t}function rn(t,n){let r=n[0],e=n[1],a=n[2],i=n[3],o=n[4],u=n[5],c=n[6],s=n[7],f=n[8],l=n[9],h=n[10],d=n[11],m=n[12],_=n[13],M=n[14],p=n[15],v=r*u-e*o,b=r*c-a*o,x=r*s-i*o,g=e*c-a*u,T=e*s-i*u,E=a*s-i*c,R=f*_-l*m,y=f*M-h*m,w=f*p-d*m,A=l*M-h*_,D=l*p-d*_,q=h*p-d*M,U=v*q-b*D+x*A+g*w-T*y+E*R;return U?(U=1/U,t[0]=(u*q-c*D+s*A)*U,t[1]=(a*D-e*q-i*A)*U,t[2]=(_*E-M*T+p*g)*U,t[3]=(h*T-l*E-d*g)*U,t[4]=(c*w-o*q-s*y)*U,t[5]=(r*q-a*w+i*y)*U,t[6]=(M*x-m*E-p*b)*U,t[7]=(f*E-h*x+d*b)*U,t[8]=(o*D-u*w+s*R)*U,t[9]=(e*w-r*D-i*R)*U,t[10]=(m*T-_*x+p*v)*U,t[11]=(l*x-f*T-d*v)*U,t[12]=(u*y-o*A-c*R)*U,t[13]=(r*A-e*y+a*R)*U,t[14]=(_*b-m*g-M*v)*U,t[15]=(f*g-l*b+h*v)*U,t):null}function en(t,n){let r=n[0],e=n[1],a=n[2],i=n[3],o=n[4],u=n[5],c=n[6],s=n[7],f=n[8],l=n[9],h=n[10],d=n[11],m=n[12],_=n[13],M=n[14],p=n[15];return t[0]=u*(h*p-d*M)-l*(c*p-s*M)+_*(c*d-s*h),t[1]=-(e*(h*p-d*M)-l*(a*p-i*M)+_*(a*d-i*h)),t[2]=e*(c*p-s*M)-u*(a*p-i*M)+_*(a*s-i*c),t[3]=-(e*(c*d-s*h)-u*(a*d-i*h)+l*(a*s-i*c)),t[4]=-(o*(h*p-d*M)-f*(c*p-s*M)+m*(c*d-s*h)),t[5]=r*(h*p-d*M)-f*(a*p-i*M)+m*(a*d-i*h),t[6]=-(r*(c*p-s*M)-o*(a*p-i*M)+m*(a*s-i*c)),t[7]=r*(c*d-s*h)-o*(a*d-i*h)+f*(a*s-i*c),t[8]=o*(l*p-d*_)-f*(u*p-s*_)+m*(u*d-s*l),t[9]=-(r*(l*p-d*_)-f*(e*p-i*_)+m*(e*d-i*l)),t[10]=r*(u*p-s*_)-o*(e*p-i*_)+m*(e*s-i*u),t[11]=-(r*(u*d-s*l)-o*(e*d-i*l)+f*(e*s-i*u)),t[12]=-(o*(l*M-h*_)-f*(u*M-c*_)+m*(u*h-c*l)),t[13]=r*(l*M-h*_)-f*(e*M-a*_)+m*(e*h-a*l),t[14]=-(r*(u*M-c*_)-o*(e*M-a*_)+m*(e*c-a*u)),t[15]=r*(u*h-c*l)-o*(e*h-a*l)+f*(e*c-a*u),t}function an(t){let n=t[0],r=t[1],e=t[2],a=t[3],i=t[4],o=t[5],u=t[6],c=t[7],s=t[8],f=t[9],l=t[10],h=t[11],d=t[12],m=t[13],_=t[14],M=t[15];return(n*o-r*i)*(l*M-h*_)-(n*u-e*i)*(f*M-h*m)+(n*c-a*i)*(f*_-l*m)+(r*u-e*o)*(s*M-h*d)-(r*c-a*o)*(s*_-l*d)+(e*c-a*u)*(s*m-f*d)}function on(t,n,r){let e=n[0],a=n[1],i=n[2],o=n[3],u=n[4],c=n[5],s=n[6],f=n[7],l=n[8],h=n[9],d=n[10],m=n[11],_=n[12],M=n[13],p=n[14],v=n[15],b=r[0],x=r[1],g=r[2],T=r[3];return t[0]=b*e+x*u+g*l+T*_,t[1]=b*a+x*c+g*h+T*M,t[2]=b*i+x*s+g*d+T*p,t[3]=b*o+x*f+g*m+T*v,b=r[4],x=r[5],g=r[6],T=r[7],t[4]=b*e+x*u+g*l+T*_,t[5]=b*a+x*c+g*h+T*M,t[6]=b*i+x*s+g*d+T*p,t[7]=b*o+x*f+g*m+T*v,b=r[8],x=r[9],g=r[10],T=r[11],t[8]=b*e+x*u+g*l+T*_,t[9]=b*a+x*c+g*h+T*M,t[10]=b*i+x*s+g*d+T*p,t[11]=b*o+x*f+g*m+T*v,b=r[12],x=r[13],g=r[14],T=r[15],t[12]=b*e+x*u+g*l+T*_,t[13]=b*a+x*c+g*h+T*M,t[14]=b*i+x*s+g*d+T*p,t[15]=b*o+x*f+g*m+T*v,t}function un(t,n,r){let e,a,i,o,u,c,s,f,l,h,d,m,_=r[0],M=r[1],p=r[2];return n===t?(t[12]=n[0]*_+n[4]*M+n[8]*p+n[12],t[13]=n[1]*_+n[5]*M+n[9]*p+n[13],t[14]=n[2]*_+n[6]*M+n[10]*p+n[14],t[15]=n[3]*_+n[7]*M+n[11]*p+n[15]):(e=n[0],a=n[1],i=n[2],o=n[3],u=n[4],c=n[5],s=n[6],f=n[7],l=n[8],h=n[9],d=n[10],m=n[11],t[0]=e,t[1]=a,t[2]=i,t[3]=o,t[4]=u,t[5]=c,t[6]=s,t[7]=f,t[8]=l,t[9]=h,t[10]=d,t[11]=m,t[12]=e*_+u*M+l*p+n[12],t[13]=a*_+c*M+h*p+n[13],t[14]=i*_+s*M+d*p+n[14],t[15]=o*_+f*M+m*p+n[15]),t}function cn(t,n,r){let e=r[0],a=r[1],i=r[2];return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=n[7]*a,t[8]=n[8]*i,t[9]=n[9]*i,t[10]=n[10]*i,t[11]=n[11]*i,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function sn(t,n,r,e){let a,i,o,u,c,s,f,l,h,m,_,M,p,v,b,x,g,T,E,R,y,w,A,D,q=e[0],U=e[1],F=e[2],P=Math.sqrt(q*q+U*U+F*F);return P<d?null:(q*=P=1/P,U*=P,F*=P,a=Math.sin(r),o=1-(i=Math.cos(r)),u=n[0],c=n[1],s=n[2],f=n[3],l=n[4],h=n[5],m=n[6],_=n[7],M=n[8],p=n[9],v=n[10],b=n[11],x=q*q*o+i,g=U*q*o+F*a,T=F*q*o-U*a,E=q*U*o-F*a,R=U*U*o+i,y=F*U*o+q*a,w=q*F*o+U*a,A=U*F*o-q*a,D=F*F*o+i,t[0]=u*x+l*g+M*T,t[1]=c*x+h*g+p*T,t[2]=s*x+m*g+v*T,t[3]=f*x+_*g+b*T,t[4]=u*E+l*R+M*y,t[5]=c*E+h*R+p*y,t[6]=s*E+m*R+v*y,t[7]=f*E+_*R+b*y,t[8]=u*w+l*A+M*D,t[9]=c*w+h*A+p*D,t[10]=s*w+m*A+v*D,t[11]=f*w+_*A+b*D,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)}function fn(t,n,r){let e=Math.sin(r),a=Math.cos(r),i=n[4],o=n[5],u=n[6],c=n[7],s=n[8],f=n[9],l=n[10],h=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=i*a+s*e,t[5]=o*a+f*e,t[6]=u*a+l*e,t[7]=c*a+h*e,t[8]=s*a-i*e,t[9]=f*a-o*e,t[10]=l*a-u*e,t[11]=h*a-c*e,t}function ln(t,n,r){let e=Math.sin(r),a=Math.cos(r),i=n[0],o=n[1],u=n[2],c=n[3],s=n[8],f=n[9],l=n[10],h=n[11];return n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=i*a-s*e,t[1]=o*a-f*e,t[2]=u*a-l*e,t[3]=c*a-h*e,t[8]=i*e+s*a,t[9]=o*e+f*a,t[10]=u*e+l*a,t[11]=c*e+h*a,t}function hn(t,n,r){let e=Math.sin(r),a=Math.cos(r),i=n[0],o=n[1],u=n[2],c=n[3],s=n[4],f=n[5],l=n[6],h=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=i*a+s*e,t[1]=o*a+f*e,t[2]=u*a+l*e,t[3]=c*a+h*e,t[4]=s*a-i*e,t[5]=f*a-o*e,t[6]=l*a-u*e,t[7]=h*a-c*e,t}function dn(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function mn(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _n(t,n,r){let e,a,i,o=r[0],u=r[1],c=r[2],s=Math.sqrt(o*o+u*u+c*c);return s<d?null:(o*=s=1/s,u*=s,c*=s,e=Math.sin(n),i=1-(a=Math.cos(n)),t[0]=o*o*i+a,t[1]=u*o*i+c*e,t[2]=c*o*i-u*e,t[3]=0,t[4]=o*u*i-c*e,t[5]=u*u*i+a,t[6]=c*u*i+o*e,t[7]=0,t[8]=o*c*i+u*e,t[9]=u*c*i-o*e,t[10]=c*c*i+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function Mn(t,n){let r=Math.sin(n),e=Math.cos(n);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function pn(t,n){let r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function vn(t,n){let r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function bn(t,n,r){let e=n[0],a=n[1],i=n[2],o=n[3],u=e+e,c=a+a,s=i+i,f=e*u,l=e*c,h=e*s,d=a*c,m=a*s,_=i*s,M=o*u,p=o*c,v=o*s;return t[0]=1-(d+_),t[1]=l+v,t[2]=h-p,t[3]=0,t[4]=l-v,t[5]=1-(f+_),t[6]=m+M,t[7]=0,t[8]=h+p,t[9]=m-M,t[10]=1-(f+d),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function xn(t,n){let r=new m(3),e=-n[0],a=-n[1],i=-n[2],o=n[3],u=n[4],c=n[5],s=n[6],f=n[7],l=e*e+a*a+i*i+o*o;return l>0?(r[0]=2*(u*o+f*e+c*i-s*a)/l,r[1]=2*(c*o+f*a+s*e-u*i)/l,r[2]=2*(s*o+f*i+u*a-c*e)/l):(r[0]=2*(u*o+f*e+c*i-s*a),r[1]=2*(c*o+f*a+s*e-u*i),r[2]=2*(s*o+f*i+u*a-c*e)),bn(t,n,r),t}function gn(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t}function Tn(t,n){let r=n[0],e=n[1],a=n[2],i=n[4],o=n[5],u=n[6],c=n[8],s=n[9],f=n[10];return t[0]=Math.sqrt(r*r+e*e+a*a),t[1]=Math.sqrt(i*i+o*o+u*u),t[2]=Math.sqrt(c*c+s*s+f*f),t}function En(t,n){let r=n[0]+n[5]+n[10],e=0;return r>0?(e=2*Math.sqrt(r+1),t[3]=.25*e,t[0]=(n[6]-n[9])/e,t[1]=(n[8]-n[2])/e,t[2]=(n[1]-n[4])/e):n[0]>n[5]&&n[0]>n[10]?(e=2*Math.sqrt(1+n[0]-n[5]-n[10]),t[3]=(n[6]-n[9])/e,t[0]=.25*e,t[1]=(n[1]+n[4])/e,t[2]=(n[8]+n[2])/e):n[5]>n[10]?(e=2*Math.sqrt(1+n[5]-n[0]-n[10]),t[3]=(n[8]-n[2])/e,t[0]=(n[1]+n[4])/e,t[1]=.25*e,t[2]=(n[6]+n[9])/e):(e=2*Math.sqrt(1+n[10]-n[0]-n[5]),t[3]=(n[1]-n[4])/e,t[0]=(n[8]+n[2])/e,t[1]=(n[6]+n[9])/e,t[2]=.25*e),t}function Rn(t,n,r,e){let a=n[0],i=n[1],o=n[2],u=n[3],c=a+a,s=i+i,f=o+o,l=a*c,h=a*s,d=a*f,m=i*s,_=i*f,M=o*f,p=u*c,v=u*s,b=u*f,x=e[0],g=e[1],T=e[2];return t[0]=(1-(m+M))*x,t[1]=(h+b)*x,t[2]=(d-v)*x,t[3]=0,t[4]=(h-b)*g,t[5]=(1-(l+M))*g,t[6]=(_+p)*g,t[7]=0,t[8]=(d+v)*T,t[9]=(_-p)*T,t[10]=(1-(l+m))*T,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function yn(t,n,r,e,a){let i=n[0],o=n[1],u=n[2],c=n[3],s=i+i,f=o+o,l=u+u,h=i*s,d=i*f,m=i*l,_=o*f,M=o*l,p=u*l,v=c*s,b=c*f,x=c*l,g=e[0],T=e[1],E=e[2],R=a[0],y=a[1],w=a[2],A=(1-(_+p))*g,D=(d+x)*g,q=(m-b)*g,U=(d-x)*T,F=(1-(h+p))*T,P=(M+v)*T,B=(m+b)*E,I=(M-v)*E,S=(1-(h+_))*E;return t[0]=A,t[1]=D,t[2]=q,t[3]=0,t[4]=U,t[5]=F,t[6]=P,t[7]=0,t[8]=B,t[9]=I,t[10]=S,t[11]=0,t[12]=r[0]+R-(A*R+U*y+B*w),t[13]=r[1]+y-(D*R+F*y+I*w),t[14]=r[2]+w-(q*R+P*y+S*w),t[15]=1,t}function wn(t,n){let r=n[0],e=n[1],a=n[2],i=n[3],o=r+r,u=e+e,c=a+a,s=r*o,f=e*o,l=e*u,h=a*o,d=a*u,m=a*c,_=i*o,M=i*u,p=i*c;return t[0]=1-l-m,t[1]=f+p,t[2]=h-M,t[3]=0,t[4]=f-p,t[5]=1-s-m,t[6]=d+_,t[7]=0,t[8]=h+M,t[9]=d-_,t[10]=1-s-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function An(t,n,r,e,a,i,o){let u=1/(r-n),c=1/(a-e),s=1/(i-o);return t[0]=2*i*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*c,t[6]=0,t[7]=0,t[8]=(r+n)*u,t[9]=(a+e)*c,t[10]=(o+i)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*i*2*s,t[15]=0,t}function Dn(t,n,r,e,a){let i=1/Math.tan(n/2),o=1/(e-a);return t[0]=i/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(a+e)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*a*e*o,t[15]=0,t}function qn(t,n,r,e){let a=Math.tan(n.upDegrees*Math.PI/180),i=Math.tan(n.downDegrees*Math.PI/180),o=Math.tan(n.leftDegrees*Math.PI/180),u=Math.tan(n.rightDegrees*Math.PI/180),c=2/(o+u),s=2/(a+i);return t[0]=c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=-(o-u)*c*.5,t[9]=(a-i)*s*.5,t[10]=e/(r-e),t[11]=-1,t[12]=0,t[13]=0,t[14]=e*r/(r-e),t[15]=0,t}function Un(t,n,r,e,a,i,o){let u=1/(n-r),c=1/(e-a),s=1/(i-o);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*s,t[11]=0,t[12]=(n+r)*u,t[13]=(a+e)*c,t[14]=(o+i)*s,t[15]=1,t}function Fn(t,n,r,e){let a,i,o,u,c,s,f,l,h,m,_=n[0],M=n[1],p=n[2],v=e[0],b=e[1],x=e[2],g=r[0],T=r[1],E=r[2];return Math.abs(_-g)<d&&Math.abs(M-T)<d&&Math.abs(p-E)<d?tn(t):(f=_-g,l=M-T,h=p-E,a=b*(h*=m=1/Math.sqrt(f*f+l*l+h*h))-x*(l*=m),i=x*(f*=m)-v*h,o=v*l-b*f,(m=Math.sqrt(a*a+i*i+o*o))?(a*=m=1/m,i*=m,o*=m):(a=0,i=0,o=0),u=l*o-h*i,c=h*a-f*o,s=f*i-l*a,(m=Math.sqrt(u*u+c*c+s*s))?(u*=m=1/m,c*=m,s*=m):(u=0,c=0,s=0),t[0]=a,t[1]=u,t[2]=f,t[3]=0,t[4]=i,t[5]=c,t[6]=l,t[7]=0,t[8]=o,t[9]=s,t[10]=h,t[11]=0,t[12]=-(a*_+i*M+o*p),t[13]=-(u*_+c*M+s*p),t[14]=-(f*_+l*M+h*p),t[15]=1,t)}function Pn(t,n,r,e){let a=n[0],i=n[1],o=n[2],u=e[0],c=e[1],s=e[2],f=a-r[0],l=i-r[1],h=o-r[2],d=f*f+l*l+h*h;d>0&&(f*=d=1/Math.sqrt(d),l*=d,h*=d);let m=c*h-s*l,_=s*f-u*h,M=u*l-c*f;return(d=m*m+_*_+M*M)>0&&(m*=d=1/Math.sqrt(d),_*=d,M*=d),t[0]=m,t[1]=_,t[2]=M,t[3]=0,t[4]=l*M-h*_,t[5]=h*m-f*M,t[6]=f*_-l*m,t[7]=0,t[8]=f,t[9]=l,t[10]=h,t[11]=0,t[12]=a,t[13]=i,t[14]=o,t[15]=1,t}function Bn(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function In(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}function Sn(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t[4]=n[4]+r[4],t[5]=n[5]+r[5],t[6]=n[6]+r[6],t[7]=n[7]+r[7],t[8]=n[8]+r[8],t[9]=n[9]+r[9],t[10]=n[10]+r[10],t[11]=n[11]+r[11],t[12]=n[12]+r[12],t[13]=n[13]+r[13],t[14]=n[14]+r[14],t[15]=n[15]+r[15],t}function Ln(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t[4]=n[4]-r[4],t[5]=n[5]-r[5],t[6]=n[6]-r[6],t[7]=n[7]-r[7],t[8]=n[8]-r[8],t[9]=n[9]-r[9],t[10]=n[10]-r[10],t[11]=n[11]-r[11],t[12]=n[12]-r[12],t[13]=n[13]-r[13],t[14]=n[14]-r[14],t[15]=n[15]-r[15],t}function Xn(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=n[7]*r,t[8]=n[8]*r,t[9]=n[9]*r,t[10]=n[10]*r,t[11]=n[11]*r,t[12]=n[12]*r,t[13]=n[13]*r,t[14]=n[14]*r,t[15]=n[15]*r,t}function Nn(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t[3]=n[3]+r[3]*e,t[4]=n[4]+r[4]*e,t[5]=n[5]+r[5]*e,t[6]=n[6]+r[6]*e,t[7]=n[7]+r[7]*e,t[8]=n[8]+r[8]*e,t[9]=n[9]+r[9]*e,t[10]=n[10]+r[10]*e,t[11]=n[11]+r[11]*e,t[12]=n[12]+r[12]*e,t[13]=n[13]+r[13]*e,t[14]=n[14]+r[14]*e,t[15]=n[15]+r[15]*e,t}function Gn(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]&&t[9]===n[9]&&t[10]===n[10]&&t[11]===n[11]&&t[12]===n[12]&&t[13]===n[13]&&t[14]===n[14]&&t[15]===n[15]}function Vn(t,n){let r=t[0],e=t[1],a=t[2],i=t[3],o=t[4],u=t[5],c=t[6],s=t[7],f=t[8],l=t[9],h=t[10],m=t[11],_=t[12],M=t[13],p=t[14],v=t[15],b=n[0],x=n[1],g=n[2],T=n[3],E=n[4],R=n[5],y=n[6],w=n[7],A=n[8],D=n[9],q=n[10],U=n[11],F=n[12],P=n[13],B=n[14],I=n[15];return Math.abs(r-b)<=d*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(e-x)<=d*Math.max(1,Math.abs(e),Math.abs(x))&&Math.abs(a-g)<=d*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(i-T)<=d*Math.max(1,Math.abs(i),Math.abs(T))&&Math.abs(o-E)<=d*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(u-R)<=d*Math.max(1,Math.abs(u),Math.abs(R))&&Math.abs(c-y)<=d*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(s-w)<=d*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(f-A)<=d*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(l-D)<=d*Math.max(1,Math.abs(l),Math.abs(D))&&Math.abs(h-q)<=d*Math.max(1,Math.abs(h),Math.abs(q))&&Math.abs(m-U)<=d*Math.max(1,Math.abs(m),Math.abs(U))&&Math.abs(_-F)<=d*Math.max(1,Math.abs(_),Math.abs(F))&&Math.abs(M-P)<=d*Math.max(1,Math.abs(M),Math.abs(P))&&Math.abs(p-B)<=d*Math.max(1,Math.abs(p),Math.abs(B))&&Math.abs(v-I)<=d*Math.max(1,Math.abs(v),Math.abs(I))}const On=on,zn=Ln;function Cn(){let t=new m(3);return t[0]=0,t[1]=0,t[2]=0,t}function jn(t){var n=new m(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n}function Hn(t){let n=t[0],r=t[1],e=t[2];return Math.sqrt(n*n+r*r+e*e)}function Wn(t,n,r){let e=new m(3);return e[0]=t,e[1]=n,e[2]=r,e}function Yn(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function kn(t,n,r,e){return t[0]=n,t[1]=r,t[2]=e,t}function Qn(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t}function Zn(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t}function Kn(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t[2]=n[2]*r[2],t}function $n(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t[2]=n[2]/r[2],t}function Jn(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t}function tr(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t}function nr(t,n,r){return t[0]=Math.min(n[0],r[0]),t[1]=Math.min(n[1],r[1]),t[2]=Math.min(n[2],r[2]),t}function rr(t,n,r){return t[0]=Math.max(n[0],r[0]),t[1]=Math.max(n[1],r[1]),t[2]=Math.max(n[2],r[2]),t}function er(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t}function ar(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t}function ir(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t}function or(t,n){let r=n[0]-t[0],e=n[1]-t[1],a=n[2]-t[2];return Math.sqrt(r*r+e*e+a*a)}function ur(t,n){let r=n[0]-t[0],e=n[1]-t[1],a=n[2]-t[2];return r*r+e*e+a*a}function cr(t){let n=t[0],r=t[1],e=t[2];return n*n+r*r+e*e}function sr(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t}function fr(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t}function lr(t,n){let r=n[0],e=n[1],a=n[2],i=r*r+e*e+a*a;return i>0&&(i=1/Math.sqrt(i),t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i),t}function hr(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function dr(t,n,r){let e=n[0],a=n[1],i=n[2],o=r[0],u=r[1],c=r[2];return t[0]=a*c-i*u,t[1]=i*o-e*c,t[2]=e*u-a*o,t}function mr(t,n,r,e){let a=n[0],i=n[1],o=n[2];return t[0]=a+e*(r[0]-a),t[1]=i+e*(r[1]-i),t[2]=o+e*(r[2]-o),t}function _r(t,n,r,e,a,i){let o=i*i,u=o*(2*i-3)+1,c=o*(i-2)+i,s=o*(i-1),f=o*(3-2*i);return t[0]=n[0]*u+r[0]*c+e[0]*s+a[0]*f,t[1]=n[1]*u+r[1]*c+e[1]*s+a[1]*f,t[2]=n[2]*u+r[2]*c+e[2]*s+a[2]*f,t}function Mr(t,n,r,e,a,i){let o=1-i,u=o*o,c=i*i,s=u*o,f=3*i*u,l=3*c*o,h=c*i;return t[0]=n[0]*s+r[0]*f+e[0]*l+a[0]*h,t[1]=n[1]*s+r[1]*f+e[1]*l+a[1]*h,t[2]=n[2]*s+r[2]*f+e[2]*l+a[2]*h,t}function pr(t,n){n=n||1;let r=2*_()*Math.PI,e=2*_()-1,a=Math.sqrt(1-e*e)*n;return t[0]=Math.cos(r)*a,t[1]=Math.sin(r)*a,t[2]=e*n,t}function vr(t,n,r){let e=n[0],a=n[1],i=n[2],o=r[3]*e+r[7]*a+r[11]*i+r[15];return o=o||1,t[0]=(r[0]*e+r[4]*a+r[8]*i+r[12])/o,t[1]=(r[1]*e+r[5]*a+r[9]*i+r[13])/o,t[2]=(r[2]*e+r[6]*a+r[10]*i+r[14])/o,t}function br(t,n,r){let e=n[0],a=n[1],i=n[2];return t[0]=e*r[0]+a*r[3]+i*r[6],t[1]=e*r[1]+a*r[4]+i*r[7],t[2]=e*r[2]+a*r[5]+i*r[8],t}function xr(t,n,r){let e=r[0],a=r[1],i=r[2],o=r[3],u=n[0],c=n[1],s=n[2],f=a*s-i*c,l=i*u-e*s,h=e*c-a*u,d=a*h-i*l,m=i*f-e*h,_=e*l-a*f,M=2*o;return f*=M,l*=M,h*=M,d*=2,m*=2,_*=2,t[0]=u+f+d,t[1]=c+l+m,t[2]=s+h+_,t}function gr(t,n,r,e){let a=[],i=[];return a[0]=n[0]-r[0],a[1]=n[1]-r[1],a[2]=n[2]-r[2],i[0]=a[0],i[1]=a[1]*Math.cos(e)-a[2]*Math.sin(e),i[2]=a[1]*Math.sin(e)+a[2]*Math.cos(e),t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t}function Tr(t,n,r,e){let a=[],i=[];return a[0]=n[0]-r[0],a[1]=n[1]-r[1],a[2]=n[2]-r[2],i[0]=a[2]*Math.sin(e)+a[0]*Math.cos(e),i[1]=a[1],i[2]=a[2]*Math.cos(e)-a[0]*Math.sin(e),t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t}function Er(t,n,r,e){let a=[],i=[];return a[0]=n[0]-r[0],a[1]=n[1]-r[1],a[2]=n[2]-r[2],i[0]=a[0]*Math.cos(e)-a[1]*Math.sin(e),i[1]=a[0]*Math.sin(e)+a[1]*Math.cos(e),i[2]=a[2],t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t}function Rr(t,n){let r=Wn(t[0],t[1],t[2]),e=Wn(n[0],n[1],n[2]);lr(r,r),lr(e,e);let a=hr(r,e);return a>1?0:a<-1?Math.PI:Math.acos(a)}function yr(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function wr(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]}function Ar(t,n){let r=t[0],e=t[1],a=t[2],i=n[0],o=n[1],u=n[2];return Math.abs(r-i)<=d*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(e-o)<=d*Math.max(1,Math.abs(e),Math.abs(o))&&Math.abs(a-u)<=d*Math.max(1,Math.abs(a),Math.abs(u))}const Dr=Zn,qr=Kn,Ur=$n,Fr=or,Pr=ur,Br=Hn,Ir=cr,Sr=function(){let t=Cn();return function(n,r,e,a,i,o){let u,c;for(r||(r=3),e||(e=0),c=a?Math.min(a*r+e,n.length):n.length,u=e;u<c;u+=r)t[0]=n[u],t[1]=n[u+1],t[2]=n[u+2],i(t,t,o),n[u]=t[0],n[u+1]=t[1],n[u+2]=t[2];return n}}();function Lr(){let t=new m(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function Xr(t){let n=new m(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}function Nr(t,n,r,e){let a=new m(4);return a[0]=t,a[1]=n,a[2]=r,a[3]=e,a}function Gr(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t}function Vr(t,n,r,e,a){return t[0]=n,t[1]=r,t[2]=e,t[3]=a,t}function Or(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t}function zr(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t}function Cr(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t[2]=n[2]*r[2],t[3]=n[3]*r[3],t}function jr(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t[2]=n[2]/r[2],t[3]=n[3]/r[3],t}function Hr(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t[3]=Math.ceil(n[3]),t}function Wr(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t[3]=Math.floor(n[3]),t}function Yr(t,n,r){return t[0]=Math.min(n[0],r[0]),t[1]=Math.min(n[1],r[1]),t[2]=Math.min(n[2],r[2]),t[3]=Math.min(n[3],r[3]),t}function kr(t,n,r){return t[0]=Math.max(n[0],r[0]),t[1]=Math.max(n[1],r[1]),t[2]=Math.max(n[2],r[2]),t[3]=Math.max(n[3],r[3]),t}function Qr(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t[3]=Math.round(n[3]),t}function Zr(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t}function Kr(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t[3]=n[3]+r[3]*e,t}function $r(t,n){let r=n[0]-t[0],e=n[1]-t[1],a=n[2]-t[2],i=n[3]-t[3];return Math.sqrt(r*r+e*e+a*a+i*i)}function Jr(t,n){let r=n[0]-t[0],e=n[1]-t[1],a=n[2]-t[2],i=n[3]-t[3];return r*r+e*e+a*a+i*i}function te(t){let n=t[0],r=t[1],e=t[2],a=t[3];return Math.sqrt(n*n+r*r+e*e+a*a)}function ne(t){let n=t[0],r=t[1],e=t[2],a=t[3];return n*n+r*r+e*e+a*a}function re(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t}function ee(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t[3]=1/n[3],t}function ae(t,n){let r=n[0],e=n[1],a=n[2],i=n[3],o=r*r+e*e+a*a+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=r*o,t[1]=e*o,t[2]=a*o,t[3]=i*o),t}function ie(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]}function oe(t,n,r,e){let a=n[0],i=n[1],o=n[2],u=n[3];return t[0]=a+e*(r[0]-a),t[1]=i+e*(r[1]-i),t[2]=o+e*(r[2]-o),t[3]=u+e*(r[3]-u),t}function ue(t,n){var r,e,a,i,o,u;n=n||1;do{o=(r=2*_()-1)*r+(e=2*_()-1)*e}while(o>=1);do{u=(a=2*_()-1)*a+(i=2*_()-1)*i}while(u>=1);var c=Math.sqrt((1-o)/u);return t[0]=Zr*r,t[1]=Zr*e,t[2]=Zr*a*c,t[3]=Zr*i*c,t}function ce(t,n,r){let e=n[0],a=n[1],i=n[2],o=n[3];return t[0]=r[0]*e+r[4]*a+r[8]*i+r[12]*o,t[1]=r[1]*e+r[5]*a+r[9]*i+r[13]*o,t[2]=r[2]*e+r[6]*a+r[10]*i+r[14]*o,t[3]=r[3]*e+r[7]*a+r[11]*i+r[15]*o,t}function se(t,n,r){let e=n[0],a=n[1],i=n[2],o=r[0],u=r[1],c=r[2],s=r[3],f=s*e+u*i-c*a,l=s*a+c*e-o*i,h=s*i+o*a-u*e,d=-o*e-u*a-c*i;return t[0]=f*s+d*-o+l*-c-h*-u,t[1]=l*s+d*-u+h*-o-f*-c,t[2]=h*s+d*-c+f*-u-l*-o,t[3]=n[3],t}function fe(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function le(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]}function he(t,n){let r=t[0],e=t[1],a=t[2],i=t[3],o=n[0],u=n[1],c=n[2],s=n[3];return Math.abs(r-o)<=d*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(e-u)<=d*Math.max(1,Math.abs(e),Math.abs(u))&&Math.abs(a-c)<=d*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(i-s)<=d*Math.max(1,Math.abs(i),Math.abs(s))}const de=zr,me=Cr,_e=jr,Me=$r,pe=Jr,ve=te,be=ne,xe=function(){let t=Lr();return function(n,r,e,a,i,o){let u,c;for(r||(r=4),e||(e=0),c=a?Math.min(a*r+e,n.length):n.length,u=e;u<c;u+=r)t[0]=n[u],t[1]=n[u+1],t[2]=n[u+2],t[3]=n[u+3],i(t,t,o),n[u]=t[0],n[u+1]=t[1],n[u+2]=t[2],n[u+3]=t[3];return n}}();function ge(){let t=new m(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Te(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Ee(t,n,r){r*=.5;let e=Math.sin(r);return t[0]=e*n[0],t[1]=e*n[1],t[2]=e*n[2],t[3]=Math.cos(r),t}function Re(t,n){let r=2*Math.acos(n[3]),e=Math.sin(r/2);return 0!=e?(t[0]=n[0]/e,t[1]=n[1]/e,t[2]=n[2]/e):(t[0]=1,t[1]=0,t[2]=0),r}function ye(t,n,r){let e=n[0],a=n[1],i=n[2],o=n[3],u=r[0],c=r[1],s=r[2],f=r[3];return t[0]=e*f+o*u+a*s-i*c,t[1]=a*f+o*c+i*u-e*s,t[2]=i*f+o*s+e*c-a*u,t[3]=o*f-e*u-a*c-i*s,t}function we(t,n,r){r*=.5;let e=n[0],a=n[1],i=n[2],o=n[3],u=Math.sin(r),c=Math.cos(r);return t[0]=e*c+o*u,t[1]=a*c+i*u,t[2]=i*c-a*u,t[3]=o*c-e*u,t}function Ae(t,n,r){r*=.5;let e=n[0],a=n[1],i=n[2],o=n[3],u=Math.sin(r),c=Math.cos(r);return t[0]=e*c-i*u,t[1]=a*c+o*u,t[2]=i*c+e*u,t[3]=o*c-a*u,t}function De(t,n,r){r*=.5;let e=n[0],a=n[1],i=n[2],o=n[3],u=Math.sin(r),c=Math.cos(r);return t[0]=e*c+a*u,t[1]=a*c-e*u,t[2]=i*c+o*u,t[3]=o*c-i*u,t}function qe(t,n){let r=n[0],e=n[1],a=n[2];return t[0]=r,t[1]=e,t[2]=a,t[3]=Math.sqrt(Math.abs(1-r*r-e*e-a*a)),t}function Ue(t,n,r,e){let a,i,o,u,c,s=n[0],f=n[1],l=n[2],h=n[3],d=r[0],m=r[1],_=r[2],M=r[3];return(i=s*d+f*m+l*_+h*M)<0&&(i=-i,d=-d,m=-m,_=-_,M=-M),1-i>1e-6?(a=Math.acos(i),o=Math.sin(a),u=Math.sin((1-e)*a)/o,c=Math.sin(e*a)/o):(u=1-e,c=e),t[0]=u*s+c*d,t[1]=u*f+c*m,t[2]=u*l+c*_,t[3]=u*h+c*M,t}function Fe(t,n){let r=n[0],e=n[1],a=n[2],i=n[3],o=r*r+e*e+a*a+i*i,u=o?1/o:0;return t[0]=-r*u,t[1]=-e*u,t[2]=-a*u,t[3]=i*u,t}function Pe(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t}function Be(t,n){let r,e=n[0]+n[4]+n[8];if(e>0)r=Math.sqrt(e+1),t[3]=.5*r,r=.5/r,t[0]=(n[5]-n[7])*r,t[1]=(n[6]-n[2])*r,t[2]=(n[1]-n[3])*r;else{let e=0;n[4]>n[0]&&(e=1),n[8]>n[3*e+e]&&(e=2);let a=(e+1)%3,i=(e+2)%3;r=Math.sqrt(n[3*e+e]-n[3*a+a]-n[3*i+i]+1),t[e]=.5*r,r=.5/r,t[3]=(n[3*a+i]-n[3*i+a])*r,t[a]=(n[3*a+e]+n[3*e+a])*r,t[i]=(n[3*i+e]+n[3*e+i])*r}return t}function Ie(t,n,r,e){let a=.5*Math.PI/180;n*=a,r*=a,e*=a;let i=Math.sin(n),o=Math.cos(n),u=Math.sin(r),c=Math.cos(r),s=Math.sin(e),f=Math.cos(e);return t[0]=i*c*f-o*u*s,t[1]=o*u*f+i*c*s,t[2]=o*c*s-i*u*f,t[3]=o*c*f+i*u*s,t}function Se(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}const Le=Xr,Xe=Nr,Ne=Gr,Ge=Vr,Ve=Or,Oe=ye,ze=Zr,Ce=ie,je=oe,He=te,We=He,Ye=ne,ke=Ye,Qe=ae,Ze=le,Ke=he,$e=function(){let t=Cn(),n=Wn(1,0,0),r=Wn(0,1,0);return function(e,a,i){let o=hr(a,i);return o<-.999999?(dr(t,n,a),Br(t)<1e-6&&dr(t,r,a),lr(t,t),Ee(e,t,Math.PI),e):o>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(dr(t,a,i),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=1+o,Qe(e,e))}}(),Je=function(){let t=ge(),n=ge();return function(r,e,a,i,o,u){return Ue(t,e,o,u),Ue(n,a,i,u),Ue(r,t,n,2*u*(1-u)),r}}(),ta=function(){let t=pt();return function(n,r,e,a){return t[0]=e[0],t[3]=e[1],t[6]=e[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],Qe(n,Be(n,t))}}();function na(){let t=new m(8);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function ra(t){let n=new m(8);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n}function ea(t,n,r,e,a,i,o,u){let c=new m(8);return c[0]=t,c[1]=n,c[2]=r,c[3]=e,c[4]=a,c[5]=i,c[6]=o,c[7]=u,c}function aa(t,n,r,e,a,i,o){let u=new m(8);u[0]=t,u[1]=n,u[2]=r,u[3]=e;let c=.5*a,s=.5*i,f=.5*o;return u[4]=c*e+s*r-f*n,u[5]=s*e+f*t-c*r,u[6]=f*e+c*n-s*t,u[7]=-c*t-s*n-f*r,u}function ia(t,n,r){let e=.5*r[0],a=.5*r[1],i=.5*r[2],o=n[0],u=n[1],c=n[2],s=n[3];return t[0]=o,t[1]=u,t[2]=c,t[3]=s,t[4]=e*s+a*c-i*u,t[5]=a*s+i*o-e*c,t[6]=i*s+e*u-a*o,t[7]=-e*o-a*u-i*c,t}function oa(t,n){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*n[0],t[5]=.5*n[1],t[6]=.5*n[2],t[7]=0,t}function ua(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function ca(t,n){let r=ge();En(r,n);let e=new m(3);return gn(e,n),ia(t,r,e),t}function sa(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t}function fa(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function la(t,n,r,e,a,i,o,u,c){return t[0]=n,t[1]=r,t[2]=e,t[3]=a,t[4]=i,t[5]=o,t[6]=u,t[7]=c,t}const ha=Ne;function da(t,n){return t[0]=n[4],t[1]=n[5],t[2]=n[6],t[3]=n[7],t}const ma=Ne;function _a(t,n){return t[4]=n[0],t[5]=n[1],t[6]=n[2],t[7]=n[3],t}function Ma(t,n){let r=n[4],e=n[5],a=n[6],i=n[7],o=-n[0],u=-n[1],c=-n[2],s=n[3];return t[0]=2*(r*s+i*o+e*c-a*u),t[1]=2*(e*s+i*u+a*o-r*c),t[2]=2*(a*s+i*c+r*u-e*o),t}function pa(t,n,r){let e=n[0],a=n[1],i=n[2],o=n[3],u=.5*r[0],c=.5*r[1],s=.5*r[2],f=n[4],l=n[5],h=n[6],d=n[7];return t[0]=e,t[1]=a,t[2]=i,t[3]=o,t[4]=o*u+a*s-i*c+f,t[5]=o*c+i*u-e*s+l,t[6]=o*s+e*c-a*u+h,t[7]=-e*u-a*c-i*s+d,t}function va(t,n,r){let e=-n[0],a=-n[1],i=-n[2],o=n[3],u=n[4],c=n[5],s=n[6],f=n[7],l=u*o+f*e+c*i-s*a,h=c*o+f*a+s*e-u*i,d=s*o+f*i+u*a-c*e,m=f*o-u*e-c*a-s*i;return we(t,n,r),e=t[0],a=t[1],i=t[2],o=t[3],t[4]=l*o+m*e+h*i-d*a,t[5]=h*o+m*a+d*e-l*i,t[6]=d*o+m*i+l*a-h*e,t[7]=m*o-l*e-h*a-d*i,t}function ba(t,n,r){let e=-n[0],a=-n[1],i=-n[2],o=n[3],u=n[4],c=n[5],s=n[6],f=n[7],l=u*o+f*e+c*i-s*a,h=c*o+f*a+s*e-u*i,d=s*o+f*i+u*a-c*e,m=f*o-u*e-c*a-s*i;return Ae(t,n,r),e=t[0],a=t[1],i=t[2],o=t[3],t[4]=l*o+m*e+h*i-d*a,t[5]=h*o+m*a+d*e-l*i,t[6]=d*o+m*i+l*a-h*e,t[7]=m*o-l*e-h*a-d*i,t}function xa(t,n,r){let e=-n[0],a=-n[1],i=-n[2],o=n[3],u=n[4],c=n[5],s=n[6],f=n[7],l=u*o+f*e+c*i-s*a,h=c*o+f*a+s*e-u*i,d=s*o+f*i+u*a-c*e,m=f*o-u*e-c*a-s*i;return De(t,n,r),e=t[0],a=t[1],i=t[2],o=t[3],t[4]=l*o+m*e+h*i-d*a,t[5]=h*o+m*a+d*e-l*i,t[6]=d*o+m*i+l*a-h*e,t[7]=m*o-l*e-h*a-d*i,t}function ga(t,n,r){let e=r[0],a=r[1],i=r[2],o=r[3],u=n[0],c=n[1],s=n[2],f=n[3];return t[0]=u*o+f*e+c*i-s*a,t[1]=c*o+f*a+s*e-u*i,t[2]=s*o+f*i+u*a-c*e,t[3]=f*o-u*e-c*a-s*i,u=n[4],c=n[5],s=n[6],f=n[7],t[4]=u*o+f*e+c*i-s*a,t[5]=c*o+f*a+s*e-u*i,t[6]=s*o+f*i+u*a-c*e,t[7]=f*o-u*e-c*a-s*i,t}function Ta(t,n,r){let e=n[0],a=n[1],i=n[2],o=n[3],u=r[0],c=r[1],s=r[2],f=r[3];return t[0]=e*f+o*u+a*s-i*c,t[1]=a*f+o*c+i*u-e*s,t[2]=i*f+o*s+e*c-a*u,t[3]=o*f-e*u-a*c-i*s,u=r[4],c=r[5],s=r[6],f=r[7],t[4]=e*f+o*u+a*s-i*c,t[5]=a*f+o*c+i*u-e*s,t[6]=i*f+o*s+e*c-a*u,t[7]=o*f-e*u-a*c-i*s,t}function Ea(t,n,r,e){if(Math.abs(e)<d)return sa(t,n);let a=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);e*=.5;let i=Math.sin(e),o=i*r[0]/a,u=i*r[1]/a,c=i*r[2]/a,s=Math.cos(e),f=n[0],l=n[1],h=n[2],m=n[3];t[0]=f*s+m*o+l*c-h*u,t[1]=l*s+m*u+h*o-f*c,t[2]=h*s+m*c+f*u-l*o,t[3]=m*s-f*o-l*u-h*c;let _=n[4],M=n[5],p=n[6],v=n[7];return t[4]=_*s+v*o+M*c-p*u,t[5]=M*s+v*u+p*o-_*c,t[6]=p*s+v*c+_*u-M*o,t[7]=v*s-_*o-M*u-p*c,t}function Ra(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t[4]=n[4]+r[4],t[5]=n[5]+r[5],t[6]=n[6]+r[6],t[7]=n[7]+r[7],t}function ya(t,n,r){let e=n[0],a=n[1],i=n[2],o=n[3],u=r[4],c=r[5],s=r[6],f=r[7],l=n[4],h=n[5],d=n[6],m=n[7],_=r[0],M=r[1],p=r[2],v=r[3];return t[0]=e*v+o*_+a*p-i*M,t[1]=a*v+o*M+i*_-e*p,t[2]=i*v+o*p+e*M-a*_,t[3]=o*v-e*_-a*M-i*p,t[4]=e*f+o*u+a*s-i*c+l*v+m*_+h*p-d*M,t[5]=a*f+o*c+i*u-e*s+h*v+m*M+d*_-l*p,t[6]=i*f+o*s+e*c-a*u+d*v+m*p+l*M-h*_,t[7]=o*f-e*u-a*c-i*s+m*v-l*_-h*M-d*p,t}const wa=ya;function Aa(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=n[7]*r,t}const Da=Ce;function qa(t,n,r,e){let a=1-e;return Da(n,r)<0&&(e=-e),t[0]=n[0]*a+r[0]*e,t[1]=n[1]*a+r[1]*e,t[2]=n[2]*a+r[2]*e,t[3]=n[3]*a+r[3]*e,t[4]=n[4]*a+r[4]*e,t[5]=n[5]*a+r[5]*e,t[6]=n[6]*a+r[6]*e,t[7]=n[7]*a+r[7]*e,t}function Ua(t,n){let r=Ia(n);return t[0]=-n[0]/r,t[1]=-n[1]/r,t[2]=-n[2]/r,t[3]=n[3]/r,t[4]=-n[4]/r,t[5]=-n[5]/r,t[6]=-n[6]/r,t[7]=n[7]/r,t}function Fa(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t[4]=-n[4],t[5]=-n[5],t[6]=-n[6],t[7]=n[7],t}const Pa=He,Ba=Pa,Ia=Ye,Sa=Ia;function La(t,n){let r=Ia(n);return r>0&&(r=Math.sqrt(r),t[0]=n[0]/r,t[1]=n[1]/r,t[2]=n[2]/r,t[3]=n[3]/r,t[4]=n[4]/r,t[5]=n[5]/r,t[6]=n[6]/r,t[7]=n[7]/r),t}function Xa(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function Na(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]}function Ga(t,n){let r=t[0],e=t[1],a=t[2],i=t[3],o=t[4],u=t[5],c=t[6],s=t[7],f=n[0],l=n[1],h=n[2],m=n[3],_=n[4],M=n[5],p=n[6],v=n[7];return Math.abs(r-f)<=d*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(e-l)<=d*Math.max(1,Math.abs(e),Math.abs(l))&&Math.abs(a-h)<=d*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(i-m)<=d*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(o-_)<=d*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(u-M)<=d*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(c-p)<=d*Math.max(1,Math.abs(c),Math.abs(p))&&Math.abs(s-v)<=d*Math.max(1,Math.abs(s),Math.abs(v))}function Va(){let t=new m(2);return t[0]=0,t[1]=0,t}function Oa(t){let n=new m(2);return n[0]=t[0],n[1]=t[1],n}function za(t,n){let r=new m(2);return r[0]=t,r[1]=n,r}function Ca(t,n){return t[0]=n[0],t[1]=n[1],t}function ja(t,n,r){return t[0]=n,t[1]=r,t}function Ha(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t}function Wa(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t}function Ya(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t}function ka(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t}function Qa(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t}function Za(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t}function Ka(t,n,r){return t[0]=Math.min(n[0],r[0]),t[1]=Math.min(n[1],r[1]),t}function $a(t,n,r){return t[0]=Math.max(n[0],r[0]),t[1]=Math.max(n[1],r[1]),t}function Ja(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t}function ti(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t}function ni(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t}function ri(t,n){var r=n[0]-t[0],e=n[1]-t[1];return Math.sqrt(r*r+e*e)}function ei(t,n){var r=n[0]-t[0],e=n[1]-t[1];return r*r+e*e}function ai(t){var n=t[0],r=t[1];return Math.sqrt(n*n+r*r)}function ii(t){var n=t[0],r=t[1];return n*n+r*r}function oi(t,n){return t[0]=-n[0],t[1]=-n[1],t}function ui(t,n){return t[0]=1/n[0],t[1]=1/n[1],t}function ci(t,n){var r=n[0],e=n[1],a=r*r+e*e;return a>0&&(a=1/Math.sqrt(a),t[0]=n[0]*a,t[1]=n[1]*a),t}function si(t,n){return t[0]*n[0]+t[1]*n[1]}function fi(t,n,r){var e=n[0]*r[1]-n[1]*r[0];return t[0]=t[1]=0,t[2]=e,t}function li(t,n,r,e){var a=n[0],i=n[1];return t[0]=a+e*(r[0]-a),t[1]=i+e*(r[1]-i),t}function hi(t,n){n=n||1;var r=2*_()*Math.PI;return t[0]=Math.cos(r)*n,t[1]=Math.sin(r)*n,t}function di(t,n,r){var e=n[0],a=n[1];return t[0]=r[0]*e+r[2]*a,t[1]=r[1]*e+r[3]*a,t}function mi(t,n,r){var e=n[0],a=n[1];return t[0]=r[0]*e+r[2]*a+r[4],t[1]=r[1]*e+r[3]*a+r[5],t}function _i(t,n,r){var e=n[0],a=n[1];return t[0]=r[0]*e+r[3]*a+r[6],t[1]=r[1]*e+r[4]*a+r[7],t}function Mi(t,n,r){let e=n[0],a=n[1];return t[0]=r[0]*e+r[4]*a+r[12],t[1]=r[1]*e+r[5]*a+r[13],t}function pi(t,n,r,e){let a=n[0]-r[0],i=n[1]-r[1],o=Math.sin(e),u=Math.cos(e);return t[0]=a*u-i*o+r[0],t[1]=a*o+i*u+r[1],t}function vi(t,n){let r=t[0],e=t[1],a=n[0],i=n[1],o=r*r+e*e;o>0&&(o=1/Math.sqrt(o));let u=a*a+i*i;u>0&&(u=1/Math.sqrt(u));let c=(r*a+e*i)*o*u;return c>1?0:c<-1?Math.PI:Math.acos(c)}function bi(t){return"vec2("+t[0]+", "+t[1]+")"}function xi(t,n){return t[0]===n[0]&&t[1]===n[1]}function gi(t,n){let r=t[0],e=t[1],a=n[0],i=n[1];return Math.abs(r-a)<=d*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(e-i)<=d*Math.max(1,Math.abs(e),Math.abs(i))}const Ti=ai,Ei=Wa,Ri=Ya,yi=ka,wi=ri,Ai=ei,Di=ii,qi=function(){let t=Va();return function(n,r,e,a,i,o){let u,c;for(r||(r=2),e||(e=0),c=a?Math.min(a*r+e,n.length):n.length,u=e;u<c;u+=r)t[0]=n[u],t[1]=n[u+1],i(t,t,o),n[u]=t[0],n[u+1]=t[1];return n}}();r.d(n,"glMatrix",function(){return e}),r.d(n,"mat2",function(){return a}),r.d(n,"mat2d",function(){return i}),r.d(n,"mat3",function(){return o}),r.d(n,"mat4",function(){return u}),r.d(n,"quat",function(){return f}),r.d(n,"quat2",function(){return l}),r.d(n,"vec2",function(){return h}),r.d(n,"vec3",function(){return c}),r.d(n,"vec4",function(){return s})},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(0);n.HitRecord=class{constructor(t=0,n=e.vec3.create(),r=e.vec3.create()){this.t=t,this.pos=n,this.normal=r,this.material=null}clear(){this.t=0,e.vec3.set(this.pos,0,0,0),e.vec3.set(this.normal,0,0,0),this.material=null}};n.Hitable=class{}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(16);let a;n.is_mobile=!1;let i=33,o=0,u=0,c=0,s=1e4;function f(){let t=Date.now();t-o>i?u<s&&(requestAnimationFrame(l),o=t):setTimeout(f,i-(t-o))}function l(){a.draw(),++c>a.num_quadrants&&(c=0,document.getElementById("webgl-text").textContent=""+ ++u),f()}!function(){/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(n.is_mobile=!0,i=66);let t=document.getElementById("canvas-webgl2");a=new e.WebglRenderer(t),o=Date.now(),f()}()},function(t,n){t.exports=function(t){function n(n){(t=(0|n)%2147483647)<=0&&(t+=2147483646)}function r(){return t=48271*t%2147483647}return n(t),{seed:n,nextInt:r,nextFloat:function(){return(r()-1)/2147483646}}}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(0),a=r(13),i=r(1),o=r(12),u=r(11),c=r(5),s=r(10),f=r(2),l=r(3)(1);n.default=l;n.SoftwareRenderer=class{constructor(t){this.ambient_light=e.vec3.fromValues(.5,.7,1),this.temp=e.vec3.create(),this.temp_rec=new i.HitRecord,this.max_ray_bounce=f.is_mobile?8:16,this.num_samples=f.is_mobile?12:16,this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.image_data=this.ctx.createImageData(this.canvas.width,this.canvas.height)}draw(){let t=this.canvas.width,n=this.canvas.height,r=e.vec3.create(),i=e.vec3.create(),f=Array(5);f[0]=new o.Sphere(e.vec3.fromValues(0,0,-1),.5,new s.Lambertian(e.vec3.fromValues(.1,.2,.5))),f[1]=new o.Sphere(e.vec3.fromValues(0,-100.5,-1),100,new s.Lambertian(e.vec3.fromValues(.8,.8,0))),f[2]=new o.Sphere(e.vec3.fromValues(1,0,-1),.5,new s.Metal(e.vec3.fromValues(.8,.6,.2),.3)),f[3]=new o.Sphere(e.vec3.fromValues(-1,0,-1),.5,new s.Dielectric(1.5)),f[4]=new o.Sphere(e.vec3.fromValues(-1,0,-1),-.45,new s.Dielectric(1.5));let h=new u.HitableList(f),d=e.vec3.fromValues(3,3,2),m=e.vec3.fromValues(0,0,-1),_=e.vec3.fromValues(0,1,0),M=e.vec3.distance(d,m),p=new c.Camera(d,m,_,20,t/n,.02,M),v=new a.Ray;for(let a=0;a<n;a++)for(let o=0;o<t;o++){e.vec3.set(i,0,0,0);for(let u=0;u<this.num_samples;u++){let u=(o+l.nextFloat()-.5)/t,c=1-(a+l.nextFloat()-.5)/n;p.getRay(v,u,c),this.color(r,v,h),e.vec3.add(i,i,r)}e.vec3.scale(i,i,1/this.num_samples),e.vec3.set(i,Math.sqrt(i[0]),Math.sqrt(i[1]),Math.sqrt(i[2])),this.setPixelv3f(this.image_data,o,a,i)}this.ctx.putImageData(this.image_data,0,0)}color(t,n,r){let a=e.vec3.fromValues(1,1,1),i=e.vec3.create();for(let o=0;o<=this.max_ray_bounce;o++){if(!r.hit(n,.001,Number.MAX_VALUE,this.temp_rec)){e.vec3.copy(this.temp,n.direction),e.vec3.normalize(this.temp,this.temp);let r=.5*(this.temp[1]+1);e.vec3.set(t,1-r+r*this.ambient_light[0],1-r+r*this.ambient_light[1],1-r+r*this.ambient_light[2]);break}this.temp_rec.material.scatter(n,n,this.temp_rec,i)?e.vec3.mul(a,a,i):e.vec3.set(a,0,0,0)}return e.vec3.mul(t,t,a),t}colorLERP(t,n,r,e){t[0]=n[0]*(1-e)+r[0]*e,t[1]=n[1]*(1-e)+r[1]*e,t[2]=n[2]*(1-e)+r[2]*e}setPixelv3f(t,n,r,e,a=1){let i=4*(n+r*t.width);t.data[i+0]=255.99*e[0],t.data[i+1]=255.99*e[1],t.data[i+2]=255.99*e[2],t.data[i+3]=255.99*a}getPixelv3f(t,n,r,e){let a=4*(n+r*t.width);e[0]=t.data[a+0]/255,e[1]=t.data[a+1]/255,e[2]=t.data[a+2]/255}setPixelf(t,n,r,e,a,i,o=1){let u=4*(n+r*t.width);t.data[u+0]=255.99*e,t.data[u+1]=255.99*a,t.data[u+2]=255.99*i,t.data[u+3]=255.99*o}setPixel(t,n,r,e,a,i,o=255){let u=4*(n+r*t.width);t.data[u+0]=e,t.data[u+1]=a,t.data[u+2]=i,t.data[u+3]=o}setPixelv3(t,n,r,e,a=255){let i=4*(n+r*t.width);t.data[i+0]=e[0],t.data[i+1]=e[1],t.data[i+2]=e[2],t.data[i+3]=a}}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(0),a=r(4);n.Camera=class{constructor(t,n,r,a,i,o,u){this.lower_left_corner=e.vec3.create(),this.screen_horizontal=e.vec3.create(),this.screen_vertical=e.vec3.create(),this.position=e.vec3.create(),this.temp=e.vec3.create(),this.temp2=e.vec3.create(),this.lens_radius=o/2;let c=a*Math.PI/180,s=Math.tan(c/2),f=i*s;e.vec3.copy(this.position,t);let l=e.vec3.sub(e.vec3.create(),t,n);e.vec3.normalize(l,l);let h=e.vec3.cross(e.vec3.create(),r,l);e.vec3.normalize(h,h);let d=e.vec3.cross(e.vec3.create(),l,h);this.lower_left_corner[0]=this.position[0]-u*f*h[0]-u*s*d[0]-u*l[0],this.lower_left_corner[1]=this.position[1]-u*f*h[1]-u*s*d[1]-u*l[1],this.lower_left_corner[2]=this.position[2]-u*f*h[2]-u*s*d[2]-u*l[2],this.screen_horizontal=e.vec3.scale(e.vec3.create(),h,2*f*u),this.screen_vertical=e.vec3.scale(e.vec3.create(),d,2*s*u)}getRay(t,n,r){let i=this.temp2,o=this.temp;return e.vec3.scale(i,function(t){do{e.vec3.set(t,2*a.default.nextFloat()-1,2*a.default.nextFloat()-1,0)}while(e.vec3.dot(t,t)>=1);return t}(i),this.lens_radius),o[0]=this.screen_horizontal[0]*i[0]+this.screen_vertical[0]*i[1],o[1]=this.screen_horizontal[1]*i[0]+this.screen_vertical[1]*i[1],o[2]=this.screen_horizontal[2]*i[0]+this.screen_vertical[2]*i[1],e.vec3.add(t.origin,this.position,o),t.direction[0]=this.lower_left_corner[0]+n*this.screen_horizontal[0]+r*this.screen_vertical[0]-this.position[0]-o[0],t.direction[1]=this.lower_left_corner[1]+n*this.screen_horizontal[1]+r*this.screen_vertical[1]-this.position[1]-o[1],t.direction[2]=this.lower_left_corner[2]+n*this.screen_horizontal[2]+r*this.screen_vertical[2]-this.position[2]-o[2],t}}},function(t,n){t.exports="#version 300 es\r\nprecision mediump float;\r\n// Ouput data\r\nlayout(location = 0) out vec4 color;\r\n\r\nuniform sampler2D u_texture;\r\n\r\nin vec2 tex_coord;\r\n\r\n// Converts a color from linear light gamma to sRGB gamma\r\nvec4 fromLinear(vec4 linearRGB)\r\n{\r\n    bvec4 cutoff = lessThan(linearRGB, vec4(0.0031308));\r\n    vec4 higher = vec4(1.055)*pow(linearRGB, vec4(1.0/2.4)) - vec4(0.055);\r\n    vec4 lower = linearRGB * vec4(12.92);\r\n\r\n    return mix(higher, lower, cutoff);\r\n}\r\n\r\n// Converts a color from sRGB gamma to linear light gamma\r\nvec4 toLinear(vec4 sRGB)\r\n{\r\n    bvec4 cutoff = lessThan(sRGB, vec4(0.04045));\r\n    vec4 higher = pow((sRGB + vec4(0.055))/vec4(1.055), vec4(2.4));\r\n    vec4 lower = sRGB/vec4(12.92);\r\n\r\n    return mix(higher, lower, cutoff);\r\n}\r\n\r\nvoid main()\r\n{\r\n\tvec3 c = texture(u_texture, tex_coord).rgb;\r\n\tcolor = fromLinear(vec4(c,1.0));\r\n//    if (tex_coord.x < 0.25)\r\n//        color = vec4(pow(color.r, 1./2.2),pow(color.g, 1./2.2),pow(color.b, 1./2.2),1.0);   // 2.2 Gamma\r\n//    else if (tex_coord.x < 0.5)\r\n//        color = fromLinear(color);        // sRGB \r\n//    else if (tex_coord.x < 0.75)\r\n//        color = (sqrt(color));    // sqrt approximation         \r\n//    else\r\n//        color = color;                // unadjusted\r\n}"},function(t,n){t.exports="#version 300 es\r\n\r\n// Input vertex data, different for all executions of this shader.\r\nlayout(location = 0) in vec3 a_vertex;\r\n\r\n// Output data ; will be interpolated for each fragment.\r\nout vec2 tex_coord;\r\n\r\nvoid main()\r\n{\r\n\tgl_Position =  vec4(a_vertex,1);\r\n\ttex_coord = (a_vertex.xy + vec2(1.0,1.0)) / (2.0);\r\n}\r\n\r\n"},function(t,n){t.exports="#version 300 es\r\nprecision highp  float;\r\nlayout (location = 0) in vec3 a_vertex;\r\n\r\nout vec2 pos;\r\nout vec3 eye;\r\nout vec3 ray_direction;\r\n\r\nconst vec2 pos_fix = vec2(0.5);\r\n\r\nstruct Screen{\r\n    vec3 position;\r\n    vec3 lower_left_corner;\r\n    vec3 horizontal;\r\n    vec3 vertical;\r\n    float lens_radius;\r\n    float x_wiggle;\r\n    float y_wiggle;\r\n};\r\n\r\nuniform Screen screen;\r\nuniform float rand_seed0;\r\nuniform float rand_seed1;\r\nuniform float width;\r\nuniform float height;\r\n\r\nuniform int num_quadrants;\r\nuniform int current_quadrant;\r\nuniform int quadrants_per_row;\r\n\r\nfloat random2(vec3 scale, float seed){\r\n    return fract(sin(dot(a_vertex + seed, scale)) * 43758.5453 + seed);\r\n}\r\n\r\nvoid main()\r\n{\r\n    //match the quad to the quadrant we are rendering\r\n    float scale = 1. / float(quadrants_per_row);\r\n    vec3 new_vertex = a_vertex * vec3(scale) + vec3(float(1) - vec3(scale)) ;\r\n    \r\n    new_vertex.x -=  float(current_quadrant%quadrants_per_row) * scale * 2.;\r\n    new_vertex.y -=  floor(float(current_quadrant) / float(quadrants_per_row)) * scale * 2.;\r\n    \r\n    //fix position from -1 to 1 to 0 to 1\r\n    pos = new_vertex.xy * pos_fix + pos_fix;\r\n    \r\n    eye = screen.position;\r\n\r\n    ray_direction = screen.lower_left_corner +\r\n        screen.x_wiggle*1.0 + pos.x * screen.horizontal + \r\n        screen.y_wiggle*1.0 + pos.y * screen.vertical - \r\n        eye;\r\n        \r\n    gl_Position = vec4(new_vertex,1.0);\r\n}   "},function(t,n){t.exports="#version 300 es\r\nprecision highp float;\r\n#define FLT_MAX 3.402823466e+38\r\n\r\nin vec2 pos;\r\nin vec3 eye;\r\nin vec3 ray_direction;\r\n\r\nlayout(location=0) out vec4 fragColor;\r\nlayout(location=1) out vec4 fragColor2;\r\n\r\nuniform float width;\r\nuniform float height;\r\n\r\nstruct Ray{\r\n    vec3 origin;\r\n    vec3 direction;\r\n};\r\n\r\nconst int Diffuse = 0;\r\nconst int Reflect = 1;\r\nconst int Refract = 2;\r\n\r\nstruct Material{\r\n    int type;\r\n    vec3 color;\r\n    float fuzz;\r\n    float refraction_index;\r\n};\r\n\r\nstruct HitRecord{\r\n    float t;\r\n    vec3 pos;\r\n    vec3 normal;\r\n    Material mat;\r\n};\r\n\r\nstruct Sphere{\r\n    vec3 center;\r\n    float radius;\r\n    Material mat;\r\n};\r\n\r\nstruct Screen{\r\n    vec3 position;\r\n    vec3 lower_left_corner;\r\n    vec3 horizontal;\r\n    vec3 vertical;\r\n    float lens_radius;\r\n    float x_wiggle;\r\n    float y_wiggle;\r\n};\r\n\r\nuniform Screen screen;\r\n\r\nuniform vec3 ambient_light;\r\nuniform int sphere_count;\r\nuniform int sample_count;\r\nuniform int samples;\r\nuniform int max_ray_bounce;\r\n//uniform Sphere spheres[150];\r\n\r\nuniform float rand_seed0;\r\nuniform float rand_seed1;\r\nuniform sampler2D last_frame;\r\nuniform float sphere_texture_size;\r\nuniform sampler2D sphere_texture;\r\nuniform sampler2D mat_texture; \r\nuniform sampler2D mat_texture_extra; \r\n\r\n\r\n\r\nfloat random(vec3 scale, float seed){\r\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\r\n}\r\n\r\nvec3 uniformlyRandomDirection(float seed) {\r\n   float u = random(vec3(12.9898, 78.233, 151.7182), seed);\r\n   float v = random(vec3(63.7264, 10.873, 623.6736), seed);\r\n   float z = 1.0 - 2.0 * u;\r\n   float r = sqrt(1.0 - z * z);\r\n   float angle = 6.283185307179586 * v;\r\n   return vec3(r * cos(angle), r * sin(angle), z);\r\n}\r\n\r\nvec3 uniformlyRandomVector(float seed){\r\n    return uniformlyRandomDirection(seed) * sqrt(random(vec3(36.7539, 50.3658, 306.2759), seed));\r\n}\r\n\r\nvec2 uniformlyRandomVec2(vec3 scale, float seed, float seed2){\r\n    float r = sqrt(random(scale.xyz,seed));\r\n    float t = (random(scale.xyz,seed2))* 6.283185307179586;\r\n    vec2 result;\r\n    result.x = r * cos(t);\r\n    result.y = r * sin(t);\r\n    return result;\r\n}\r\n\r\n\r\nvec3 cosineWeightedDirection(float seed, vec3 normal){\r\n    float u =random(vec3(12.9898, 78.233, 151.7182), seed);\r\n    float v = random(vec3(63.7264, 10.873, 623.6736), seed);\r\n    float r = sqrt(u);\r\n    float angle = 6.283185307179586 * v;\r\n    vec3 sdir, tdir;\r\n    if (abs(normal.x) < 0.5)\r\n        sdir = cross(normal, vec3(1,0,0));\r\n    else \r\n        sdir = cross(normal, vec3(0,1,0));\r\n    \r\n    tdir = cross(normal, sdir);\r\n    return r*cos(angle)*sdir + r*sin(angle)*tdir + sqrt(1.-u)*normal;\r\n}\r\n\r\n//Schlick used for refraction\r\nfloat schlick(float cosine, float ref_idx){\r\n    float r0 = (1.0-ref_idx) / (1.0 + ref_idx);\r\n    r0 = r0*r0;\r\n    return r0 + (1.0-r0) * pow((1.0 - cosine), 5.0);\r\n}\r\n\r\n//Intersect with this sphere. updates hit record\r\nbool sphereIntersection(Sphere s, Ray ray, float t_min, float t_max, inout HitRecord rec){\r\n    vec3 to_sphere = ray.origin - s.center;\r\n    float a = dot(ray.direction, ray.direction);\r\n    float b = dot(to_sphere, ray.direction);\r\n    float c = dot(to_sphere,to_sphere) - s.radius * s.radius;\r\n    float discriminant = b * b -  a * c;\r\n    \r\n    float temp = (-b - sqrt(discriminant)) / a;\r\n    if(temp < t_max && temp > t_min){\r\n        rec.t = temp;\r\n        rec.pos = ray.origin + rec.t * ray.direction;\r\n        rec.normal = (rec.pos - s.center) / s.radius;\r\n        return true;\r\n    }\r\n    temp = (-b + sqrt(discriminant)) / a;\r\n    if(temp < t_max && temp > t_min){\r\n       rec.t = temp;\r\n       rec.pos = ray.origin + rec.t * ray.direction;\r\n       rec.normal = (rec.pos - s.center) / s.radius;\r\n       return true;\r\n    }\r\n    \r\n    return false;\r\n}\r\n\r\n//Intersects with all objects and updates the hit record\r\nbool intersectAll(Ray ray, float t_min, float t_max, inout HitRecord rec){\r\n    bool hit_anything = false;\r\n    float closest_so_far = t_max;\r\n    \r\n    //Spheres Loop\r\n    Sphere sphere;\r\n    float index_of_hit = 0.0;\r\n    float index;\r\n    vec4 s;\r\n    for(int i = 0; i < sphere_count; i++){\r\n        index = float(i) / float(sphere_texture_size);\r\n        s = texture(sphere_texture, vec2(index,0.5));\r\n        sphere.center = s.xyz;\r\n        sphere.radius = s.w;     \r\n\r\n        if(sphereIntersection(sphere, ray, t_min, closest_so_far, rec)){\r\n            index_of_hit = index;\r\n            hit_anything = true;\r\n            closest_so_far = rec.t;\r\n        }\r\n    }\r\n    \r\n    //If we don't hit anything it doesnt matter since this data won't be used\r\n    rec.mat.color = texture(mat_texture, vec2(index_of_hit,0.5)).rgb; \r\n    vec2 mat = texture(mat_texture_extra, vec2(index_of_hit,0.5)).xy;\r\n    rec.mat.type = int(mat.x);\r\n    rec.mat.fuzz = mat.y;\r\n    rec.mat.refraction_index = mat.y;\r\n        \r\n    return hit_anything;\r\n}\r\n\r\nvec3 color(inout Ray ray){\r\n    HitRecord rec;\r\n    vec3 final_color = vec3(0.0);\r\n    vec3 color = vec3(1.0);\r\n\r\n    for(int ray_bounce=0; ray_bounce <= max_ray_bounce; ray_bounce++){\r\n        float rf = float(ray_bounce);\r\n        \r\n        if(intersectAll(ray, 0.01, FLT_MAX, rec )){\r\n            ray.origin = rec.pos;\r\n            vec3 rand =  uniformlyRandomDirection(rand_seed1 + rf);    \r\n            \r\n            if(rec.mat.type == Diffuse){\r\n                ray.direction = rec.normal + rand;\r\n                color *= rec.mat.color;\r\n                \r\n            }else if(rec.mat.type == Reflect){     \r\n                vec3 reflected = reflect(normalize(ray.direction), rec.normal);\r\n                ray.direction = reflected + rec.mat.fuzz * rand;\r\n                if(dot(ray.direction, rec.normal) > 0.0)\r\n                    color *= rec.mat.color;\r\n                else\r\n                    color = vec3(0);\r\n                    \r\n            }else if(rec.mat.type == Refract){\r\n                vec3 outward_normal;\r\n                float ni_over_nt;\r\n                float reflect_prob;\r\n                float cosine;\r\n                vec3 reflected = reflect(normalize(ray.direction), rec.normal);\r\n               \r\n                if(dot(ray.direction, rec.normal) > 0.0){\r\n                   outward_normal = -rec.normal;\r\n                   ni_over_nt = rec.mat.refraction_index;\r\n                   cosine = rec.mat.refraction_index * dot(ray.direction, rec.normal) / length(ray.direction);\r\n                }else{\r\n                   outward_normal = rec.normal;\r\n                   ni_over_nt = 1.0 / rec.mat.refraction_index;\r\n                   cosine = -dot(ray.direction, rec.normal) / length(ray.direction);\r\n                }\r\n                \r\n                vec3 refracted = refract(normalize(ray.direction), outward_normal, ni_over_nt);\r\n                if(length(refracted) > 0.0){\r\n                   reflect_prob = schlick(cosine, rec.mat.refraction_index);\r\n                }else{\r\n                   reflect_prob = 1.0;\r\n                }\r\n                \r\n                float r = random(rand, rand_seed0 + rf);\r\n                if(r > reflect_prob){\r\n                   ray.direction = refracted;\r\n                }else\r\n                   ray.direction = reflected;\r\n            }\r\n            \r\n        }else{\r\n             vec3 unit_direction = normalize(ray.direction);\r\n             float t = 0.5 * (unit_direction.y + 1.0);\r\n             final_color =  (1.0 - t) * vec3(1.0) +   t * ambient_light  ;\r\n             break;\r\n        }\r\n    }\r\n    return color*final_color;\r\n}\r\n\r\nvoid main()\r\n{      \r\n    vec3 prev_color =  texture(last_frame, vec2(pos.xy)).rgb;\r\n\r\n    //Random depth of field blur based on lens radius\r\n    vec2 rd =  screen.lens_radius * (uniformlyRandomVec2(gl_FragCoord.xyz, rand_seed0, rand_seed1));\r\n    vec3 offset =  screen.horizontal * rd.x + screen.vertical * rd.y;\r\n\r\n    Ray ray;\r\n    ray.origin =  eye + offset;\r\n    ray.direction = ray_direction - offset ;\r\n\r\n    vec3 new_color = color(ray);\r\n\r\n    float blend =  1.0 / float(sample_count+1);\r\n    //if(blend < 0.0025) blend = 0.0025;\r\n\r\n    //Blend new color with color of last frame\r\n    vec3 final_color = mix(prev_color,new_color,blend);\r\n\r\n    fragColor = vec4(final_color,1.0);         \r\n    fragColor2 = fragColor;\r\n    \r\n}\r\n\r\n\r\n"},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(0),a=r(4);class i{}n.Material=i;n.Lambertian=class extends i{constructor(t=e.vec3.create()){super(),this.temp=e.vec3.create(),this.albedo=t}scatter(t,n,r,a){return e.vec3.add(this.temp,o(this.temp),r.normal),e.vec3.copy(t.origin,r.pos),e.vec3.copy(t.direction,this.temp),e.vec3.copy(a,this.albedo),!0}};n.Metal=class extends i{constructor(t=e.vec3.create(),n=0){super(),this.temp=e.vec3.create(),this.albedo=e.vec3.create(),this.albedo=t,this.fuzz=n>1?1:n<0?0:n}scatter(t,n,r,a){return e.vec3.normalize(this.temp,n.direction),e.vec3.copy(t.origin,r.pos),e.vec3.add(t.direction,u(t.direction,this.temp,r.normal),e.vec3.scale(o(this.temp),this.temp,this.fuzz)),e.vec3.copy(a,this.albedo),e.vec3.dot(t.direction,r.normal)>0}};function o(t){do{e.vec3.set(t,2*a.default.nextFloat()-1,2*a.default.nextFloat()-1,2*a.default.nextFloat()-1)}while(e.vec3.dot(t,t)>=1);return t}function u(t,n,r){let a=e.vec3.dot(r,n);return t[0]=n[0]-2*r[0]*a,t[1]=n[1]-2*r[1]*a,t[2]=n[2]-2*r[2]*a,t}n.Dielectric=class extends i{constructor(t){super(),this.temp=e.vec3.create(),this.outward_normal=e.vec3.create(),this.refracted=e.vec3.create(),this.reflected=e.vec3.create(),this.refraction_index=t}scatter(t,n,r,i){let o,c,s;return e.vec3.normalize(this.temp,n.direction),u(this.reflected,this.temp,r.normal),e.vec3.set(i,1,1,1),e.vec3.dot(n.direction,r.normal)>0?(e.vec3.negate(this.outward_normal,r.normal),o=this.refraction_index,c=this.refraction_index*e.vec3.dot(n.direction,r.normal)/e.vec3.length(n.direction)):(e.vec3.copy(this.outward_normal,r.normal),o=1/this.refraction_index,c=-e.vec3.dot(n.direction,r.normal)/e.vec3.length(n.direction)),e.vec3.normalize(this.temp,n.direction),function(t,n,r,a){let i=e.vec3.dot(n,r),o=1-a*a*(1-i*i);if(o>0){let e=Math.sqrt(o);return t[0]=a*(n[0]-r[0]*i)-r[0]*e,t[1]=a*(n[1]-r[1]*i)-r[1]*e,t[2]=a*(n[2]-r[2]*i)-r[2]*e,!0}e.vec3.set(t,0,0,0)}(this.refracted,this.temp,this.outward_normal,o),s=e.vec3.length(this.refracted)>0?function(t,n){let r=(1-n)/(1+n);return(r*=r)+(1-r)*Math.pow(1-t,5)}(c,this.refraction_index):1,a.default.nextFloat()<s?e.vec3.copy(t.direction,this.reflected):e.vec3.copy(t.direction,this.refracted),e.vec3.copy(t.origin,r.pos),!0}}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(1);n.HitableList=class extends e.Hitable{constructor(t=[]){super(),this.list=t,this.temp_rec=new e.HitRecord}hit(t,n,r,e){let a=!1,i=r;for(let r of this.list)r.hit(t,n,i,e)&&(a=!0,i=e.t);return a}}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(1),a=r(0);n.Sphere=class extends e.Hitable{constructor(t,n,r){super(),this.center=t,this.radius=n,this.material=r,this.temp=a.vec3.create()}hit(t,n,r,e){let i=a.vec3.sub(this.temp,t.origin,this.center),o=a.vec3.dot(t.direction,t.direction),u=a.vec3.dot(i,t.direction),c=u*u-o*(a.vec3.dot(i,i)-this.radius*this.radius);if(c>0){let a=(-u-Math.sqrt(c))/o;if(a<r&&a>n)return e.t=a,t.pointAtParameter(e.pos,e.t),e.normal[0]=(e.pos[0]-this.center[0])/this.radius,e.normal[1]=(e.pos[1]-this.center[1])/this.radius,e.normal[2]=(e.pos[2]-this.center[2])/this.radius,e.material=this.material,!0;if((a=(-u+Math.sqrt(c))/o)<r&&a>n)return e.t=a,t.pointAtParameter(e.pos,e.t),e.normal[0]=(e.pos[0]-this.center[0])/this.radius,e.normal[1]=(e.pos[1]-this.center[1])/this.radius,e.normal[2]=(e.pos[2]-this.center[2])/this.radius,e.material=this.material,!0}return!1}}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(0);n.Ray=class{constructor(t=e.vec3.create(),n=e.vec3.create()){this.origin=t,this.direction=n}pointAtParameter(t,n){return t[0]=this.origin[0]+n*this.direction[0],t[1]=this.origin[1]+n*this.direction[1],t[2]=this.origin[2]+n*this.direction[2],t}}},function(t,n,r){"use strict";var e;Object.defineProperty(n,"__esModule",{value:!0}),function(t){t[t.Diffuse=0]="Diffuse",t[t.Reflect=1]="Reflect",t[t.Refract=2]="Refract"}(e=n.MatType||(n.MatType={}));n.Material=class{constructor(t,n,r){switch(this.type=t,t){case e.Diffuse:this.diffuse=n;break;case e.Reflect:this.reflect=n,this.fuzz=r;break;case e.Refract:this.refraction_index=r}}}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.Shader=class{constructor(t,n,r){this.gl=t;let e=this.getShader(t,n,t.VERTEX_SHADER),a=this.getShader(t,r,t.FRAGMENT_SHADER);this.ID=t.createProgram(),t.attachShader(this.ID,e),t.attachShader(this.ID,a),t.linkProgram(this.ID),t.getProgramParameter(this.ID,t.LINK_STATUS)||alert("Could not initialize shaders"),this.uniforms=new Map,this.attributes=new Map}delete(){this.gl.deleteShader(this.ID),delete this.uniforms,delete this.attributes}use(){this.gl.useProgram(this.ID)}setAttributes(t){this.use();for(let n of t)this.attributes.set(n,this.gl.getAttribLocation(this.ID,n))}setUniforms(t){this.use();for(let[n,r]of t)r&&this.setAny(n,r)}getUniformLocation(t){let n=this.uniforms.get(t);return void 0===n&&(n=this.gl.getUniformLocation(this.ID,t),this.uniforms.set(t,n)),n}getAttribLocation(t){let n=this.attributes.get(t);return void 0===n&&(n=this.gl.getAttribLocation(this.ID,t)),n}setBool(t,n){this.gl.uniform1i(t,n?1:0)}setBoolByName(t,n){this.gl.uniform1i(this.getUniformLocation(t),n?1:0)}setInt(t,n){this.gl.uniform1i(t,n)}setIntByName(t,n){this.gl.uniform1i(this.getUniformLocation(t),n)}setIntV(t,n){this.gl.uniform1iv(t,n)}setIntVByName(t,n){this.gl.uniform1iv(this.getUniformLocation(t),n)}setFloat(t,n){this.gl.uniform1f(t,n)}setFloatByName(t,n){this.gl.uniform1f(this.getUniformLocation(t),n)}setMat4(t,n){this.gl.uniformMatrix4fv(t,!1,n)}setMat4ByName(t,n){this.gl.uniformMatrix4fv(this.getUniformLocation(t),!1,n)}setVec3(t,n){this.gl.uniform3fv(t,n)}setVec3ByName(t,n){this.gl.uniform3fv(this.getUniformLocation(t),n)}setVec4(t,n){this.gl.uniform4fv(t,n)}setVec4ByName(t,n){this.gl.uniform4fv(this.getUniformLocation(t),n)}setAny(t,n){let r=this.getUniformLocation(t);"number"==typeof n?this.setFloat(r,n):"boolean"===n?this.setBool(r,n):n instanceof Float32Array&&(3==n.length&&this.setVec3(r,n),4==n.length&&this.setVec4(r,n),16==n.length&&this.setMat4(r,n))}getShader(t,n,r){let e;return e=t.createShader(r),t.shaderSource(e,n),t.compileShader(e),t.getShaderParameter(e,t.COMPILE_STATUS)?e:(alert(t.getShaderInfoLog(e)),null)}}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(15),a=r(0),i=r(14),o=r(2),u=r(5),c=r(3)(49);n.WebglRenderer=class{constructor(t){this.sample_count=0,this.default_quadrants_row=o.is_mobile?4:2,this.default_quadrants_col=o.is_mobile?4:2,this.render_width=0,this.render_height=0,this.super_sampling=o.is_mobile?2:3,this.max_ray_bounce=o.is_mobile?12:24,this.ambient_light=a.vec3.fromValues(.5,.7,1),0===this.super_sampling&&(this.super_sampling=1),this.num_quadrants=this.super_sampling*this.super_sampling*this.default_quadrants_row*this.default_quadrants_col,this.current_quadrant=0,this.initGL(t),this.initRenderTexture(),this.initShader();let n=a.vec3.fromValues(10,1.9,2.5),r=a.vec3.fromValues(4,.5,1),e=a.vec3.fromValues(0,1,0),i=a.vec3.distance(n,r);this.bigSphereScene(),this.setCamera(n,r,e,30,this.gl.drawingBufferWidth/this.gl.drawingBufferHeight,.01,i),this.initBuffers()}draw(){let t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.frame_buffer),t.viewport(0,0,this.render_width,this.render_height),this.shader.use(),this.shader.setIntByName("sample_count",this.sample_count),this.shader.setFloatByName("rand_seed0",c.nextFloat()),this.shader.setFloatByName("rand_seed1",c.nextFloat()),this.shader.setIntByName("current_quadrant",this.current_quadrant),this.wiggleCamera(),t.bindVertexArray(this.VAO),t.bindTexture(t.TEXTURE_2D,this.float_texture_copy),t.drawArrays(t.TRIANGLES,0,6),t.drawBuffers([t.COLOR_ATTACHMENT0,t.COLOR_ATTACHMENT1]),this.float_tex_ext?t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA32F,0,0,this.render_width,this.render_height,0):t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,this.render_width,this.render_height,0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),this.quad_shader.use(),t.bindVertexArray(this.VAO),t.bindTexture(t.TEXTURE_2D,this.quad_render_texture),t.drawArrays(t.TRIANGLES,0,6),this.current_quadrant++,this.current_quadrant>=this.num_quadrants&&(this.current_quadrant=0,this.sample_count++)}initGL(t){try{this.gl=t.getContext("webgl2")}catch(t){throw"GL init error:\n"+t}this.gl||alert("WebGL2 is not available on your browser."),this.gl.disable(this.gl.SAMPLE_COVERAGE),this.gl.clearColor(.2,.3,.3,1),this.gl.disable(this.gl.DEPTH_TEST)}initShader(){let t=this.gl;const n=r(9),a=r(8);this.shader=new e.Shader(this.gl,a,n),this.quad_shader=new e.Shader(t,r(7),r(6)),this.shader.setAttributes(["a_vertex"]);let i=new Map;i.set("width",this.gl.drawingBufferWidth),i.set("height",this.gl.drawingBufferHeight),this.shader.setIntByName("max_ray_bounce",this.max_ray_bounce),this.shader.setIntByName("num_quadrants",this.num_quadrants),this.shader.setIntByName("quadrants_per_row",this.super_sampling*this.default_quadrants_row),this.shader.setIntByName("last_frame",0),i.set("ambient_light",this.ambient_light),this.shader.setUniforms(i),t.bindVertexArray(this.VAO),this.quad_shader.use(),this.quad_shader.setIntByName("u_texture",0)}initRenderTexture(){let t=this.gl;this.render_width=this.gl.drawingBufferWidth*this.super_sampling,this.render_height=this.gl.drawingBufferHeight*this.super_sampling,this.frame_buffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.frame_buffer),this.float_tex_ext=t.getExtension("EXT_color_buffer_float"),this.float_texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.float_texture),this.float_tex_ext?t.texImage2D(t.TEXTURE_2D,0,t.RGBA32F,this.render_width,this.render_height,0,t.RGBA,t.FLOAT,null):o.is_mobile?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.render_width,this.render_height,0,t.RGBA,t.UNSIGNED_BYTE,null):t.texImage2D(t.TEXTURE_2D,0,t.RGB10_A2,this.render_width,this.render_height,0,t.RGBA,t.UNSIGNED_INT_2_10_10_10_REV,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.float_texture,0),this.quad_render_texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.quad_render_texture),o.is_mobile?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.render_width,this.render_height,0,t.RGBA,t.UNSIGNED_BYTE,null):t.texImage2D(t.TEXTURE_2D,0,t.RGB10_A2,this.render_width,this.render_height,0,t.RGBA,t.UNSIGNED_INT_2_10_10_10_REV,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT1,t.TEXTURE_2D,this.quad_render_texture,0);const n=t.checkFramebufferStatus(t.FRAMEBUFFER);console.log(`${n===t.FRAMEBUFFER_COMPLETE?"good":"bad  "} frame buffer`),this.float_texture_copy=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.float_texture_copy),this.float_tex_ext?t.texImage2D(t.TEXTURE_2D,0,t.RGBA32F,this.render_width,this.render_height,0,t.RGBA,t.FLOAT,null):o.is_mobile?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.render_width,this.render_height,0,t.RGBA,t.UNSIGNED_BYTE,null):t.texImage2D(t.TEXTURE_2D,0,t.RGB10_A2,this.render_width,this.render_height,0,t.RGBA,t.UNSIGNED_INT_2_10_10_10_REV,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST)}bigSphereScene(){this.shader.use();let t=this.gl,n=t.createTexture(),r=t.createTexture(),e=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);let u=[],s=[],f=[];u.push(0,-1e3,0,1e3),s.push(127.5,127.5,127.5,255),f.push(i.MatType.Diffuse,0,0,0),u.push(0,1,0,1),s.push(0,255,0,0),f.push(i.MatType.Refract,1.2,0,0),u.push(0,1,0,-.95),s.push(0,0,0,0),f.push(i.MatType.Refract,1.2,0,0),u.push(-4,1,0,1),s.push(102,51,25.5,0),f.push(i.MatType.Diffuse,0,0,0),u.push(4,1,0,1),s.push(178.5,153,127.5,0),f.push(i.MatType.Reflect,0,0,0);let l=o.is_mobile?-2:-11,h=o.is_mobile?7:11;for(let t=l;t<h;t++)for(let n=l;n<h;n++){let r=c.nextFloat(),e=a.vec3.fromValues(t+.9*c.nextFloat(),.2,n+.9*c.nextFloat());a.vec3.distance(e,a.vec3.fromValues(4,.2,0))>.9&&(r<.5?(u.push(e[0],e[1],e[2],.2),s.push(255*c.nextFloat(),255*c.nextFloat(),255*c.nextFloat(),0),f.push(i.MatType.Diffuse,0,0,0)):r<.75?(u.push(e[0],e[1],e[2],.2),s.push(.5*(1+c.nextFloat())*255,.5*(1+c.nextFloat())*255,.5*(1+c.nextFloat())*255,0),f.push(i.MatType.Reflect,.5*c.nextFloat(),0,0)):r<.95?(u.push(e[0],e[1],e[2],.2),s.push(0,0,0,0),f.push(i.MatType.Refract,1.5,0,0)):(u.push(e[0],e[1],e[2],.2),s.push(0,0,0,0),f.push(i.MatType.Refract,1.5,0,0),u.push(e[0],e[1],e[2],-.18),s.push(0,0,0,0),f.push(i.MatType.Refract,1.5,0,0)))}let d=u.length/4,m=d;d=Math.pow(2,Math.ceil(Math.log(d)/Math.log(2)));for(let t=m;t<=d;t++)u.push(0,0,0,0),s.push(0,0,0,0),f.push(0,0,0,0);t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA32F,d,1,0,t.RGBA,t.FLOAT,new Float32Array(u)),this.shader.setIntByName("sphere_texture",1),t.activeTexture(t.TEXTURE2),t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA8,d,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(s)),this.shader.setIntByName("mat_texture",2),t.activeTexture(t.TEXTURE3),t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA32F,d,1,0,t.RGBA,t.FLOAT,new Float32Array(f)),this.shader.setIntByName("mat_texture_extra",3),this.shader.setIntByName("sphere_count",m),this.shader.setFloatByName("sphere_texture_size",d)}setCamera(t,n,r,e,a,i,o){let s=new u.Camera(t,n,r,e,a,i,o);this.shader.use(),this.shader.setVec3ByName("screen.lower_left_corner",s.lower_left_corner),this.shader.setVec3ByName("screen.horizontal",s.screen_horizontal),this.shader.setVec3ByName("screen.vertical",s.screen_vertical),this.shader.setVec3ByName("screen.position",s.position),this.shader.setFloatByName("screen.lens_radius",s.lens_radius),this.shader.setFloatByName("screen.x_wiggle",c.nextFloat()/this.render_width),this.shader.setFloatByName("screen.y_wiggle",c.nextFloat()/this.render_height)}wiggleCamera(){this.shader.setFloatByName("screen.x_wiggle",c.nextFloat()/this.render_width),this.shader.setFloatByName("screen.y_wiggle",c.nextFloat()/this.render_height)}initBuffers(){let t=this.gl;this.vertex_buffer=t.createBuffer(),this.VAO=t.createVertexArray(),t.bindVertexArray(this.VAO),t.activeTexture(t.TEXTURE0),t.bindBuffer(t.ARRAY_BUFFER,this.vertex_buffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,0,1,-1,0,-1,1,0,-1,1,0,1,-1,0,1,1,0]),t.STATIC_DRAW),t.enableVertexAttribArray(this.shader.getAttribLocation("a_vertex")),t.vertexAttribPointer(this.shader.getAttribLocation("a_vertex"),3,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindVertexArray(null)}}}]);
//# sourceMappingURL=bundle.js.map